<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="junit.xsl"?>
<testsuites>
  <meta_test_info page_active="no-links" link_url=""/>
  <testsuite name="pre_suite" tests="7" errors="0" failures="0" skipped="2" pending="0" total="7" time="89.224022">
    <properties>
      <property name="project" value="Beaker"/>
      <property name="department" value="unknown"/>
      <property name="created_by" value="rishi.javia"/>
      <property name="host_tags" value="{}"/>
      <property name="openstack_api_key" value=""/>
      <property name="openstack_username" value=""/>
      <property name="openstack_auth_url" value="/tokens"/>
      <property name="openstack_tenant" value=""/>
      <property name="openstack_keyname" value=""/>
      <property name="openstack_network" value=""/>
      <property name="openstack_region" value=""/>
      <property name="openstack_volume_support" value="true"/>
      <property name="jenkins_build_url" value=""/>
      <property name="validate" value="true"/>
      <property name="configure" value="true"/>
      <property name="log_level" value="debug"/>
      <property name="trace_limit" value="10"/>
      <property name="master-start-curl-retries" value="30"/>
      <property name="masterless" value="false"/>
      <property name="options_file" value="merged_options.rb"/>
      <property name="type" value="aio"/>
      <property name="provision" value="true"/>
      <property name="preserve_hosts" value="onfail"/>
      <property name="root_keys" value="false"/>
      <property name="quiet" value="false"/>
      <property name="project_root" value="/Users/rishi.javia/Documents/beaker/lib/beaker"/>
      <property name="xml_dir" value="junit"/>
      <property name="xml_file" value="beaker_junit.xml"/>
      <property name="xml_time" value="beaker_times.xml"/>
      <property name="xml_time_enabled" value="false"/>
      <property name="xml_stylesheet" value="junit.xsl"/>
      <property name="default_log_prefix" value="beaker_logs"/>
      <property name="log_dir" value="log"/>
      <property name="log_sut_event" value="sut.log"/>
      <property name="color" value="true"/>
      <property name="dry_run" value="false"/>
      <property name="test_tag_and" value="[]"/>
      <property name="test_tag_or" value="[]"/>
      <property name="test_tag_exclude" value="[]"/>
      <property name="timeout" value="900"/>
      <property name="fail_mode" value="slow"/>
      <property name="accept_all_exit_codes" value="false"/>
      <property name="timesync" value="false"/>
      <property name="disable_iptables" value="false"/>
      <property name="set_env" value="true"/>
      <property name="disable_updates" value="true"/>
      <property name="repo_proxy" value="true"/>
      <property name="package_proxy" value="false"/>
      <property name="add_el_extras" value="false"/>
      <property name="epel_url" value="http://dl.fedoraproject.org/pub/epel"/>
      <property name="epel_url_archive" value="http://archive.fedoraproject.org/pub/archive/epel"/>
      <property name="consoleport" value="443"/>
      <property name="pe_dir" value="/opt/enterprise/dists"/>
      <property name="pe_version_file" value="LATEST"/>
      <property name="pe_version_file_win" value="LATEST-win"/>
      <property name="host_env" value="{}"/>
      <property name="host_name_prefix" value=""/>
      <property name="ssh_env_file" value="~/.ssh/environment"/>
      <property name="profile_d_env_file" value="/etc/profile.d/beaker_env.sh"/>
      <property name="dot_fog" value="/Users/rishi.javia/.fog"/>
      <property name="ec2_yaml" value="config/image_templates/ec2.yaml"/>
      <property name="help" value="false"/>
      <property name="collect_perf_data" value="none"/>
      <property name="puppetdb_port_ssl" value="8081"/>
      <property name="puppetdb_port_nonssl" value="8080"/>
      <property name="puppetserver_port" value="8140"/>
      <property name="nodeclassifier_port" value="4433"/>
      <property name="cache_files_locally" value="false"/>
      <property name="aws_keyname_modifier" value="7470970895"/>
      <property name="run_in_parallel" value="[]"/>
      <property name="ssh" value="{:config=&gt;false, :paranoid=&gt;false, :auth_methods=&gt;[&quot;publickey&quot;], :port=&gt;22, :forward_agent=&gt;true, :keys=&gt;[&quot;id_rsa_acceptance&quot;, &quot;/Users/rishi.javia/.ssh/id_rsa-acceptance&quot;], :user_known_hosts_file=&gt;&quot;/Users/rishi.javia/.ssh/known_hosts&quot;, :keepalive=&gt;true}"/>
      <property name="tests" value="[&quot;tests/reports/cached_catalog_status_in_report.rb&quot;, &quot;tests/reports/corrective_change_new_resource.rb&quot;, &quot;tests/reports/corrective_change_outside_puppet.rb&quot;, &quot;tests/reports/corrective_change_via_puppet.rb&quot;, &quot;tests/reports/failover_master.rb&quot;, &quot;tests/reports/finalized_on_cycle.rb&quot;, &quot;tests/reports/submission.rb&quot;]"/>
      <property name="pre_suite" value="[&quot;setup/common/pre-suite/000-delete-puppet-when-none.rb&quot;, &quot;setup/aio/pre-suite/010_Install.rb&quot;, &quot;setup/aio/pre-suite/020_InstallCumulusModules.rb&quot;, &quot;setup/aio/pre-suite/021_InstallAristaModule.rb&quot;, &quot;setup/common/pre-suite/025_StopFirewall.rb&quot;, &quot;setup/common/pre-suite/040_ValidateSignCert.rb&quot;, &quot;setup/aio/pre-suite/045_EnsureMasterStarted.rb&quot;]"/>
      <property name="is_puppetserver" value="true"/>
      <property name="use-service" value="true"/>
      <property name="puppetservice" value="puppetserver"/>
      <property name="puppetserver-confdir" value="/etc/puppetlabs/puppetserver/conf.d"/>
      <property name="puppetserver-config" value="/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf"/>
      <property name="load_path" value="[&quot;./lib&quot;]"/>
      <property name="xml" value="true"/>
      <property name="forge_host" value="forge-aio01-petest.puppetlabs.com"/>
      <property name="hosts_file" value="/Users/rishi.javia/Documents/puppet/acceptance/centos7-pe.yml"/>
      <property name="command_line" value="/Users/rishi.javia/Documents/puppet/acceptance/vendor/bundle/ruby/2.2.0/bin/beaker --options-file merged_options.rb --hosts centos7-pe.yml --tests=tests/reports"/>
      <property name="HOSTS" value="{:&quot;centos7-64-1&quot;=&gt;{:pe_dir=&gt;nil, :pe_ver=&gt;nil, :pe_upgrade_dir=&gt;nil, :pe_upgrade_ver=&gt;nil, :hypervisor=&gt;&quot;vmpooler&quot;, :platform=&gt;&quot;el-7-x86_64&quot;, :template=&gt;&quot;centos-7-x86_64&quot;, :roles=&gt;[&quot;master&quot;, &quot;agent&quot;, &quot;dashboard&quot;, &quot;database&quot;, &quot;default&quot;], :host_tags=&gt;{}}}"/>
      <property name="nfs_server" value="none"/>
      <property name="pooling_api" value="http://vmpooler.delivery.puppetlabs.net/"/>
      <property name="home" value="/Users/rishi.javia"/>
      <property name="helper" value="[]"/>
      <property name="post_suite" value="[]"/>
      <property name="install" value="[]"/>
      <property name="pre_cleanup" value="[]"/>
      <property name="modules" value="[]"/>
      <property name="logger" value="#&lt;Beaker::Logger:0x007fe451cc73a0&gt;"/>
      <property name="timestamp" value="2017-08-08 19:25:56 -0700"/>
      <property name="beaker_version" value="3.21.1"/>
      <property name="log_prefix" value="centos7-pe"/>
      <property name="xml_dated_dir" value="junit/centos7-pe/2017-08-08_19_25_56"/>
      <property name="log_dated_dir" value="log/centos7-pe/2017-08-08_19_25_56"/>
      <property name="logger_sut" value="#&lt;Beaker::Logger:0x007fe451cc6360&gt;"/>
    </properties>
    <testcase classname="setup/common/pre-suite" name="000-delete-puppet-when-none.rb" time="0.000380">
      <system-out><![CDATA[
Expunge puppet bits if hypervisor is none
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/aio/pre-suite" name="010_Install.rb" time="31.436656">
      <system-out><![CDATA[
Install Packages

* Install puppet-agent...

* Install puppetserver...
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:03$ curl -o /etc/yum.repos.d/pl-puppetserver-latest-el-7-x86_64.repo http://nightlies.puppetlabs.com/puppetserver-latest//repo_configs/rpm/pl-puppetserver-latest-el-7-x86_64.repo
      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
      0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0    100   224  100   224    0     0   1619      0 --:--:-- --:--:-- --:--:--  1611100   224  100   224    0     0   1619      0 --:--:-- --:--:-- --:--:--  1611
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.18 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:03$ curl -o /etc/yum.repos.d/pl-puppet-agent-d33a1fddd412fce059fdc68127a0b9b31c0bfe98-el-7-x86_64.repo http://builds.puppetlabs.lan/puppet-agent/d33a1fddd412fce059fdc68127a0b9b31c0bfe98/repo_configs/rpm/pl-puppet-agent-d33a1fddd412fce059fdc68127a0b9b31c0bfe98-el-7-x86_64.repo
      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
      0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0    100   284  100   284    0     0  37070      0 --:--:    -- --:--:-- --:--:-- 40571
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
  Installing puppetserver
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:03$ yum -y  install puppetserver
    Loaded plugins: fastestmirror
    Loading mirror speeds from cached hostfile
    Resolving Dependencies
    --> Running transaction check
    ---> Package puppetserver.noarch 0:5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7 will be installed
    --> Processing Dependency: puppet-agent >= 4.99.0 for package: puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarch
    --> Processing Dependency: java-1.8.0-openjdk-headless for package: puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarch
    --> Running transaction check
    ---> Package java-1.8.0-openjdk-headless.x86_64 1:1.8.0.141-1.b16.el7_3 will be installed
    --> Processing Dependency: tzdata-java >= 2015d for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: nss(x86-64) >= 3.28.4 for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: copy-jdk-configs >= 1.1-3 for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: chkconfig >= 1.7 for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: chkconfig >= 1.7 for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: lksctp-tools(x86-64) for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: libjpeg.so.62(LIBJPEG_6.2)(64bit) for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: jpackage-utils for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    --> Processing Dependency: libjpeg.so.62()(64bit) for package: 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_64
    ---> Package puppet-agent.x86_64 0:4.99.0.597.gd33a1fd-1.el7 will be installed
    --> Running transaction check
    ---> Package chkconfig.x86_64 0:1.3.61-5.el7 will be updated
    ---> Package chkconfig.x86_64 0:1.7.2-1.el7_3.1 will be an update
    ---> Package copy-jdk-configs.noarch 0:1.2-1.el7 will be installed
    ---> Package javapackages-tools.noarch 0:3.4.1-11.el7 will be installed
    --> Processing Dependency: python-javapackages = 3.4.1-11.el7 for package: javapackages-tools-3.4.1-11.el7.noarch
    --> Processing Dependency: libxslt for package: javapackages-tools-3.4.1-11.el7.noarch
    ---> Package libjpeg-turbo.x86_64 0:1.2.90-5.el7 will be installed
    ---> Package lksctp-tools.x86_64 0:1.0.17-2.el7 will be installed
    ---> Package nss.x86_64 0:3.19.1-18.el7 will be updated
    --> Processing Dependency: nss = 3.19.1-18.el7 for package: nss-sysinit-3.19.1-18.el7.x86_64
    --> Processing Dependency: nss(x86-64) = 3.19.1-18.el7 for package: nss-tools-3.19.1-18.el7.x86_64
    ---> Package nss.x86_64 0:3.28.4-1.2.el7_3 will be an update
    --> Processing Dependency: nss-util >= 3.28.2-1.1 for package: nss-3.28.4-1.2.el7_3.x86_64
    --> Processing Dependency: nss-softokn(x86-64) >= 3.16.2.3-14.2 for package: nss-3.28.4-1.2.el7_3.x86_64
    --> Processing Dependency: nspr >= 4.13.1 for package: nss-3.28.4-1.2.el7_3.x86_64
    --> Processing Dependency: libnssutil3.so(NSSUTIL_3.24)(64bit) for package: nss-3.28.4-1.2.el7_3.x86_64
    --> Processing Dependency: libnssutil3.so(NSSUTIL_3.21)(64bit) for package: nss-3.28.4-1.2.el7_3.x86_64
    ---> Package tzdata-java.noarch 0:2017b-1.el7 will be installed
    --> Running transaction check
    ---> Package libxslt.x86_64 0:1.1.28-5.el7 will be installed
    ---> Package nspr.x86_64 0:4.10.8-2.el7_1 will be updated
    ---> Package nspr.x86_64 0:4.13.1-1.0.el7_3 will be an update
    ---> Package nss-softokn.x86_64 0:3.16.2.3-13.el7_1 will be updated
    ---> Package nss-softokn.x86_64 0:3.16.2.3-14.4.el7 will be an update
    --> Processing Dependency: nss-softokn-freebl(x86-64) >= 3.16.2.3-14.4.el7 for package: nss-softokn-3.16.2.3-14.4.el7.x86_64
    ---> Package nss-sysinit.x86_64 0:3.19.1-18.el7 will be updated
    ---> Package nss-sysinit.x86_64 0:3.28.4-1.2.el7_3 will be an update
    ---> Package nss-tools.x86_64 0:3.19.1-18.el7 will be updated
    ---> Package nss-tools.x86_64 0:3.28.4-1.2.el7_3 will be an update
    ---> Package nss-util.x86_64 0:3.19.1-4.el7_1 will be updated
    ---> Package nss-util.x86_64 0:3.28.4-1.0.el7_3 will be an update
    ---> Package python-javapackages.noarch 0:3.4.1-11.el7 will be installed
    --> Processing Dependency: python-lxml for package: python-javapackages-3.4.1-11.el7.noarch
    --> Running transaction check
    ---> Package nss-softokn-freebl.x86_64 0:3.16.2.3-13.el7_1 will be updated
    ---> Package nss-softokn-freebl.x86_64 0:3.16.2.3-14.4.el7 will be an update
    ---> Package python-lxml.x86_64 0:3.2.1-4.el7 will be installed
    --> Finished Dependency Resolution
    
    Dependencies Resolved
    
    ================================================================================
     Package            Arch   Version                 Repository              Size
    ================================================================================
    Installing:
     puppetserver       noarch 5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7
                                                       pl-puppetserver-latest  64 M
    Installing for dependencies:
     copy-jdk-configs   noarch 1.2-1.el7               localmirror-os          14 k
     java-1.8.0-openjdk-headless
                        x86_64 1:1.8.0.141-1.b16.el7_3 localmirror-updates     31 M
     javapackages-tools noarch 3.4.1-11.el7            localmirror-os          73 k
     libjpeg-turbo      x86_64 1.2.90-5.el7            localmirror-os         134 k
     libxslt            x86_64 1.1.28-5.el7            localmirror-os         242 k
     lksctp-tools       x86_64 1.0.17-2.el7            localmirror-os          88 k
     puppet-agent       x86_64 4.99.0.597.gd33a1fd-1.el7
                                                       pl-puppet-agent-d33a1fddd412fce059fdc68127a0b9b31c0bfe98
                                                                               25 M
     python-javapackages
                        noarch 3.4.1-11.el7            localmirror-os          31 k
     python-lxml        x86_64 3.2.1-4.el7             localmirror-os         758 k
     tzdata-java        noarch 2017b-1.el7             localmirror-updates    183 k
    Updating for dependencies:
     chkconfig          x86_64 1.7.2-1.el7_3.1         localmirror-updates    175 k
     nspr               x86_64 4.13.1-1.0.el7_3        localmirror-updates    126 k
     nss                x86_64 3.28.4-1.2.el7_3        localmirror-updates    872 k
     nss-softokn        x86_64 3.16.2.3-14.4.el7       localmirror-os         306 k
     nss-softokn-freebl x86_64 3.16.2.3-14.4.el7       localmirror-os         204 k
     nss-sysinit        x86_64 3.28.4-1.2.el7_3        localmirror-updates     58 k
     nss-tools          x86_64 3.28.4-1.2.el7_3        localmirror-updates    496 k
     nss-util           x86_64 3.28.4-1.0.el7_3        localmirror-updates     73 k
    
    Transaction Summary
    ================================================================================
    Install  1 Package  (+10 Dependent packages)
    Upgrade             (  8 Dependent packages)
    Total download size: 124 M
    Downloading packages:
    Delta RPMs disabled because /usr/bin/applydeltarpm not installed.
    Public key for puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarch.rpm is not installed
    warning: /var/cache/yum/x86_64/7/pl-puppetserver-latest/packages/puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarch.rpm: Header V4 RSA/SHA1 Signature, key ID 07bb6c57: NOKEY
    --------------------------------------------------------------------------------
    Total                                               27 MB/s | 124 MB  00:04     
    Retrieving key from http://nightlies.puppetlabs.com/07BB6C57
    Importing GPG key 0x07BB6C57:
     Userid     : "Puppet Labs Nightly Build Key (Puppet Labs Nightly Build Key) <delivery@puppetlabs.com>"
     Fingerprint: 8735 f5af 62a9 9a62 8ec1 3377 b8f9 99c0 07bb 6c57
     From       : http://nightlies.puppetlabs.com/07BB6C57
    Running transaction check
    Running transaction test
    Transaction test succeeded
    Running transaction
      Updating   : nspr-4.13.1-1.0.el7_3.x86_64                                1/27     
      Updating   : nss-util-3.28.4-1.0.el7_3.x86_64                            2/27     
      Updating   : nss-softokn-freebl-3.16.2.3-14.4.el7.x86_64                 3/27     
      Updating   : nss-softokn-3.16.2.3-14.4.el7.x86_64                        4/27     
      Installing : libxslt-1.1.28-5.el7.x86_64                                 5/27     
      Updating   : chkconfig-1.7.2-1.el7_3.1.x86_64                            6/27     
      Updating   : nss-3.28.4-1.2.el7_3.x86_64                                 7/27     
      Updating   : nss-sysinit-3.28.4-1.2.el7_3.x86_64                         8/27     
      Installing : python-lxml-3.2.1-4.el7.x86_64                              9/27     
      Installing : python-javapackages-3.4.1-11.el7.noarch                    10/27     
      Installing : javapackages-tools-3.4.1-11.el7.noarch                     11/27     
      Installing : puppet-agent-4.99.0.597.gd33a1fd-1.el7.x86_64              12/27     
      Installing : tzdata-java-2017b-1.el7.noarch                             13/27     
      Installing : copy-jdk-configs-1.2-1.el7.noarch                          14/27     
      Installing : lksctp-tools-1.0.17-2.el7.x86_64                           15/27     
      Installing : libjpeg-turbo-1.2.90-5.el7.x86_64                          16/27     
      Installing : 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_   17/27     
      Installing : puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarc   18/27     
    usermod: no changes
      Updating   : nss-tools-3.28.4-1.2.el7_3.x86_64                          19/27     
      Cleanup    : nss-tools-3.19.1-18.el7.x86_64                             20/27     
      Cleanup    : nss-sysinit-3.19.1-18.el7.x86_64                           21/27     
      Cleanup    : nss-3.19.1-18.el7.x86_64                                   22/27     
      Cleanup    : nss-softokn-3.16.2.3-13.el7_1.x86_64                       23/27     
      Cleanup    : nss-util-3.19.1-4.el7_1.x86_64                             24/27     
      Cleanup    : nspr-4.10.8-2.el7_1.x86_64                                 25/27     
      Cleanup    : nss-softokn-freebl-3.16.2.3-13.el7_1.x86_64                26/27     
      Cleanup    : chkconfig-1.3.61-5.el7.x86_64                              27/27     
      Verifying  : nss-tools-3.28.4-1.2.el7_3.x86_64                           1/27     
      Verifying  : nspr-4.13.1-1.0.el7_3.x86_64                                2/27     
      Verifying  : libjpeg-turbo-1.2.90-5.el7.x86_64                           3/27     
      Verifying  : nss-3.28.4-1.2.el7_3.x86_64                                 4/27     
      Verifying  : python-lxml-3.2.1-4.el7.x86_64                              5/27     
      Verifying  : nss-softokn-3.16.2.3-14.4.el7.x86_64                        6/27     
      Verifying  : puppetserver-5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7.noarc    7/27     
      Verifying  : chkconfig-1.7.2-1.el7_3.1.x86_64                            8/27     
      Verifying  : nss-util-3.28.4-1.0.el7_3.x86_64                            9/27     
      Verifying  : python-javapackages-3.4.1-11.el7.noarch                    10/27     
      Verifying  : lksctp-tools-1.0.17-2.el7.x86_64                           11/27     
      Verifying  : copy-jdk-configs-1.2-1.el7.noarch                          12/27     
      Verifying  : nss-sysinit-3.28.4-1.2.el7_3.x86_64                        13/27     
      Verifying  : libxslt-1.1.28-5.el7.x86_64                                14/27     
      Verifying  : tzdata-java-2017b-1.el7.noarch                             15/27     
      Verifying  : nss-softokn-freebl-3.16.2.3-14.4.el7.x86_64                16/27     
      Verifying  : javapackages-tools-3.4.1-11.el7.noarch                     17/27     
      Verifying  : puppet-agent-4.99.0.597.gd33a1fd-1.el7.x86_64              18/27     
      Verifying  : 1:java-1.8.0-openjdk-headless-1.8.0.141-1.b16.el7_3.x86_   19/27     
      Verifying  : nss-tools-3.19.1-18.el7.x86_64                             20/27     
      Verifying  : nss-softokn-3.16.2.3-13.el7_1.x86_64                       21/27 
      Verifying  : nss-3.19.1-18.el7.x86_64                                   22/27 
      Verifying  : nss-sysinit-3.19.1-18.el7.x86_64                           23/27 
      Verifying  : chkconfig-1.3.61-5.el7.x86_64                              24/27 
      Verifying  : nss-softokn-freebl-3.16.2.3-13.el7_1.x86_64                25/27     
      Verifying  : nspr-4.10.8-2.el7_1.x86_64                                 26/27 
      Verifying  : nss-util-3.19.1-4.el7_1.x86_64                             27/27     
    
    Installed:
      puppetserver.noarch 0:5.0.1-0.1SNAPSHOT.2017.08.06T0835.el7                   
    
    Dependency Installed:
      copy-jdk-configs.noarch 0:1.2-1.el7                                           
      java-1.8.0-openjdk-headless.x86_64 1:1.8.0.141-1.b16.el7_3                    
      javapackages-tools.noarch 0:3.4.1-11.el7                                      
      libjpeg-turbo.x86_64 0:1.2.90-5.el7                                           
      libxslt.x86_64 0:1.1.28-5.el7                                                 
      lksctp-tools.x86_64 0:1.0.17-2.el7                                            
      puppet-agent.x86_64 0:4.99.0.597.gd33a1fd-1.el7                               
      python-javapackages.noarch 0:3.4.1-11.el7                                     
      python-lxml.x86_64 0:3.2.1-4.el7                                              
      tzdata-java.noarch 0:2017b-1.el7                                              
    
    Dependency Updated:
      chkconfig.x86_64 0:1.7.2-1.el7_3.1                                            
      nspr.x86_64 0:4.13.1-1.0.el7_3                                                
      nss.x86_64 0:3.28.4-1.2.el7_3                                                 
      nss-softokn.x86_64 0:3.16.2.3-14.4.el7                                        
      nss-softokn-freebl.x86_64 0:3.16.2.3-14.4.el7                                 
      nss-sysinit.x86_64 0:3.28.4-1.2.el7_3                                         
      nss-tools.x86_64 0:3.28.4-1.2.el7_3                                           
      nss-util.x86_64 0:3.28.4-1.0.el7_3                                            
    Complete!
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 29.42 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:32$ puppet --version
  5.0.1

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.90 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:33$ env PATH="/opt/puppetlabs/puppet/bin:${PATH}" ruby --version
  ruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.07 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:33$ env PATH="/opt/puppetlabs/puppet/bin:${PATH}" ruby -e 'puts Time.now.strftime("%Y-%m-%d %T.%L %z")'
  2017-08-09 02:21:57.563 +0000

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.07 seconds
Host times vary 0 ms

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:34$ env PATH="/opt/puppetlabs/puppet/bin:${PATH}" gem source --clear-all
  *** Removed specs cache ***

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.22 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:34$ env PATH="/opt/puppetlabs/puppet/bin:${PATH}" gem source --add http://rubygems.delivery.puppetlabs.net
  http://rubygems.delivery.puppetlabs.net added to sources

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.52 seconds
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/aio/pre-suite" name="020_InstallCumulusModules.rb" time="0.000523">
      <skipped type="skip"/>
      <system-out><![CDATA[
No cumulus hosts present
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/aio/pre-suite" name="021_InstallAristaModule.rb" time="0.000462">
      <skipped type="skip"/>
      <system-out><![CDATA[
No arista hosts present
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/common/pre-suite" name="025_StopFirewall.rb" time="1.564529">
      <system-out><![CDATA[
Stop firewall
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:34$ puppet resource service firewalld ensure=stopped
    service { 'firewalld':
      ensure => 'stopped',
    }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.56 seconds
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/common/pre-suite" name="040_ValidateSignCert.rb" time="20.307326">
      <system-out><![CDATA[
Validate Sign Cert

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:36$ facter hostname
  y9sqckmg348o6r5

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.10 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:36$ facter fqdn
  y9sqckmg348o6r5.delivery.puppetlabs.net

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.09 seconds

* Ensure puppet is stopped

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:36$ puppet resource service puppetserver ensure=stopped
  service { 'puppetserver':
    ensure => 'stopped',
  }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.04 seconds

* Clear SSL on all hosts

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:37$ puppet agent --configprint ssldir
  /etc/puppetlabs/puppet/ssl

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.81 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:38$ rm -rf '/etc/puppetlabs/puppet/ssl'

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

* Master: Start Puppet Master
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:38$ mktemp -dt 040_ValidateSignCert.rb.XXXXXX
    /tmp/040_ValidateSignCert.rb.YNXeRc
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
  Setting curl retries to 30
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:38$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.95 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:39$ puppet master --configprint vardir
    /opt/puppetlabs/server/data/puppetserver
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:40$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:40$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    # configuration for the JRuby interpreters
    jruby-puppet: {
        # Where the puppet-agent dependency places puppet, facter, etc...
        # Puppet server expects to load Puppet from this location
        ruby-load-path: [/opt/puppetlabs/puppet/lib/ruby/vendor_ruby]
    
        # This setting determines where JRuby will install gems.  It is used for loading gems,
        # and also by the `puppetserver gem` command line tool.
        gem-home: /opt/puppetlabs/server/data/puppetserver/jruby-gems
    
        # This setting defines the complete "GEM_PATH" for jruby.  If set, it should include
        # the gem-home directory as well as any other directories that gems can be loaded
        # from (including the vendored gems directory for gems that ship with puppetserver)
        gem-path: [${jruby-puppet.gem-home}, "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"]
    
        # PLEASE NOTE: Use caution when modifying the below settings. Modifying
        # these settings will change the value of the corresponding Puppet settings
        # for Puppet Server, but not for the Puppet CLI tools. This likely will not
        # be a problem with master-var-dir, master-run-dir, or master-log-dir unless
        # some critical setting in puppet.conf is interpolating the value of one
        # of the corresponding settings, but it is important that any changes made to
        # master-conf-dir and master-code-dir are also made to the corresponding Puppet
        # settings when running the Puppet CLI tools. See
        # https://docs.puppetlabs.com/puppetserver/latest/puppet_conf_setting_diffs.html#overriding-puppet-settings-in-puppet-server
        # for more information.
    
        # (optional) path to puppet conf dir; if not specified, will use
        # /etc/puppetlabs/puppet
        master-conf-dir: /etc/puppetlabs/puppet
    
        # (optional) path to puppet code dir; if not specified, will use
        # /etc/puppetlabs/code
        master-code-dir: /etc/puppetlabs/code
    
        # (optional) path to puppet var dir; if not specified, will use
        # /opt/puppetlabs/server/data/puppetserver
        master-var-dir: /opt/puppetlabs/server/data/puppetserver
    
        # (optional) path to puppet run dir; if not specified, will use
        # /var/run/puppetlabs/puppetserver
        master-run-dir: /var/run/puppetlabs/puppetserver
    
        # (optional) path to puppet log dir; if not specified, will use
        # /var/log/puppetlabs/puppetserver
        master-log-dir: /var/log/puppetlabs/puppetserver
    
        # (optional) maximum number of JRuby instances to allow
        #max-active-instances: 1
    
        # (optional) Authorize access to Puppet master endpoints via rules
        # specified in the legacy Puppet auth.conf file (if true) or via rules
        # specified in the Puppet Server HOCON-formatted auth.conf (if false or not
        # specified).
        #use-legacy-auth-conf: true
    }
    
    # settings related to HTTPS client requests made by Puppet Server
    http-client: {
        # A list of acceptable protocols for making HTTPS requests
        #ssl-protocols: [TLSv1, TLSv1.1, TLSv1.2]
    
        # A list of acceptable cipher suites for making HTTPS requests
        #cipher-suites: [TLS_RSA_WITH_AES_256_CBC_SHA256,
        #                TLS_RSA_WITH_AES_256_CBC_SHA,
        #                TLS_RSA_WITH_AES_128_CBC_SHA256,
        #                TLS_RSA_WITH_AES_128_CBC_SHA]
    
        # Whether to enable http-client metrics; defaults to 'true'.
        #metrics-enabled: true
    }
    
    # settings related to profiling the puppet Ruby code
    profiler: {
        # enable or disable profiling for the Ruby code; defaults to 'true'.
        #enabled: true
    }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1kgjmz2 centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:40$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.04 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:41$ test -e /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:41$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/040_ValidateSignCert.rb.YNXeRc/puppet.conf.bak
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:41$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:42$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:43$ cat /etc/puppetlabs/puppet/puppet.conf
    # This file can be used to override the default puppet settings.
    # See the following links for more details on what settings are available:
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1gjddsx centos7-64-1:/tmp/040_ValidateSignCert.rb.YNXeRc/puppet.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:43$ cat /etc/puppetlabs/puppet/puppet.conf
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
    
    [main]
    dns_alt_names = puppet,y9sqckmg348o6r5,y9sqckmg348o6r5.delivery.puppetlabs.net
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:43$ puppet master
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 6.85 seconds
  Waiting for the puppet master to start
  The puppet master has started
  
  * Master: sign all certs
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:50$ puppet cert --sign --all
    Error: No waiting certificate requests to sign
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.53 seconds
  Exited: 24
  
  * Agents: Run agent --test second time to obtain signed cert
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:52$ puppet agent --test --server y9sqckmg348o6r5.delivery.puppetlabs.net
    Info: Using configured environment 'production'
    Info: Retrieving pluginfacts
    Info: Retrieving plugin
    Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
    Info: Applying configuration version '1502245338'
    Notice: Applied catalog in 0.02 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.86 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:54$ cat `puppet master --configprint pidfile`
    2820  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.82 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:55$ kill 2820
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:55$ kill -0 2820
    bash: line 0: kill: (2820) - No such process
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  Exited: 1
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:55$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:56$ if [ -f '/tmp/040_ValidateSignCert.rb.YNXeRc/puppet.conf.bak' ]; then cat '/tmp/040_ValidateSignCert.rb.YNXeRc/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/040_ValidateSignCert.rb.YNXeRc/puppet.conf.bak'; fi
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
Begin teardown
End teardown
]]></system-out>
    </testcase>
    <testcase classname="setup/aio/pre-suite" name="045_EnsureMasterStarted.rb" time="35.911078">
      <system-out><![CDATA[
y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:26:56$ puppet resource service puppetserver ensure=running
  Notice: /Service[puppetserver]/ensure: ensure changed 'stopped' to 'running'
  service { 'puppetserver':
    ensure => 'running',
  }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 35.91 seconds
Begin teardown
End teardown
]]></system-out>
    </testcase>
  </testsuite>
<meta_test_info page_active="no-links" link_url=""/><testsuite name="tests" tests="7" errors="0" failures="0" skipped="0" pending="0" total="7" time="173.919555"><properties><property name="project" value="Beaker"/><property name="department" value="unknown"/><property name="created_by" value="rishi.javia"/><property name="host_tags" value="{}"/><property name="openstack_api_key" value=""/><property name="openstack_username" value=""/><property name="openstack_auth_url" value="/tokens"/><property name="openstack_tenant" value=""/><property name="openstack_keyname" value=""/><property name="openstack_network" value=""/><property name="openstack_region" value=""/><property name="openstack_volume_support" value="true"/><property name="jenkins_build_url" value=""/><property name="validate" value="true"/><property name="configure" value="true"/><property name="log_level" value="debug"/><property name="trace_limit" value="10"/><property name="master-start-curl-retries" value="30"/><property name="masterless" value="false"/><property name="options_file" value="merged_options.rb"/><property name="type" value="aio"/><property name="provision" value="true"/><property name="preserve_hosts" value="onfail"/><property name="root_keys" value="false"/><property name="quiet" value="false"/><property name="project_root" value="/Users/rishi.javia/Documents/beaker/lib/beaker"/><property name="xml_dir" value="junit"/><property name="xml_file" value="beaker_junit.xml"/><property name="xml_time" value="beaker_times.xml"/><property name="xml_time_enabled" value="false"/><property name="xml_stylesheet" value="junit.xsl"/><property name="default_log_prefix" value="beaker_logs"/><property name="log_dir" value="log"/><property name="log_sut_event" value="sut.log"/><property name="color" value="true"/><property name="dry_run" value="false"/><property name="test_tag_and" value="[]"/><property name="test_tag_or" value="[]"/><property name="test_tag_exclude" value="[]"/><property name="timeout" value="900"/><property name="fail_mode" value="slow"/><property name="accept_all_exit_codes" value="false"/><property name="timesync" value="false"/><property name="disable_iptables" value="false"/><property name="set_env" value="true"/><property name="disable_updates" value="true"/><property name="repo_proxy" value="true"/><property name="package_proxy" value="false"/><property name="add_el_extras" value="false"/><property name="epel_url" value="http://dl.fedoraproject.org/pub/epel"/><property name="epel_url_archive" value="http://archive.fedoraproject.org/pub/archive/epel"/><property name="consoleport" value="443"/><property name="pe_dir" value="/opt/enterprise/dists"/><property name="pe_version_file" value="LATEST"/><property name="pe_version_file_win" value="LATEST-win"/><property name="host_env" value="{}"/><property name="host_name_prefix" value=""/><property name="ssh_env_file" value="~/.ssh/environment"/><property name="profile_d_env_file" value="/etc/profile.d/beaker_env.sh"/><property name="dot_fog" value="/Users/rishi.javia/.fog"/><property name="ec2_yaml" value="config/image_templates/ec2.yaml"/><property name="help" value="false"/><property name="collect_perf_data" value="none"/><property name="puppetdb_port_ssl" value="8081"/><property name="puppetdb_port_nonssl" value="8080"/><property name="puppetserver_port" value="8140"/><property name="nodeclassifier_port" value="4433"/><property name="cache_files_locally" value="false"/><property name="aws_keyname_modifier" value="7470970895"/><property name="run_in_parallel" value="[]"/><property name="ssh" value="{:config=&gt;false, :paranoid=&gt;false, :auth_methods=&gt;[&quot;publickey&quot;], :port=&gt;22, :forward_agent=&gt;true, :keys=&gt;[&quot;id_rsa_acceptance&quot;, &quot;/Users/rishi.javia/.ssh/id_rsa-acceptance&quot;], :user_known_hosts_file=&gt;&quot;/Users/rishi.javia/.ssh/known_hosts&quot;, :keepalive=&gt;true}"/><property name="tests" value="[&quot;tests/reports/cached_catalog_status_in_report.rb&quot;, &quot;tests/reports/corrective_change_new_resource.rb&quot;, &quot;tests/reports/corrective_change_outside_puppet.rb&quot;, &quot;tests/reports/corrective_change_via_puppet.rb&quot;, &quot;tests/reports/failover_master.rb&quot;, &quot;tests/reports/finalized_on_cycle.rb&quot;, &quot;tests/reports/submission.rb&quot;]"/><property name="pre_suite" value="[&quot;setup/common/pre-suite/000-delete-puppet-when-none.rb&quot;, &quot;setup/aio/pre-suite/010_Install.rb&quot;, &quot;setup/aio/pre-suite/020_InstallCumulusModules.rb&quot;, &quot;setup/aio/pre-suite/021_InstallAristaModule.rb&quot;, &quot;setup/common/pre-suite/025_StopFirewall.rb&quot;, &quot;setup/common/pre-suite/040_ValidateSignCert.rb&quot;, &quot;setup/aio/pre-suite/045_EnsureMasterStarted.rb&quot;]"/><property name="is_puppetserver" value="true"/><property name="use-service" value="true"/><property name="puppetservice" value="puppetserver"/><property name="puppetserver-confdir" value="/etc/puppetlabs/puppetserver/conf.d"/><property name="puppetserver-config" value="/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf"/><property name="load_path" value="[&quot;./lib&quot;]"/><property name="xml" value="true"/><property name="forge_host" value="forge-aio01-petest.puppetlabs.com"/><property name="hosts_file" value="/Users/rishi.javia/Documents/puppet/acceptance/centos7-pe.yml"/><property name="command_line" value="/Users/rishi.javia/Documents/puppet/acceptance/vendor/bundle/ruby/2.2.0/bin/beaker --options-file merged_options.rb --hosts centos7-pe.yml --tests=tests/reports"/><property name="HOSTS" value="{:&quot;centos7-64-1&quot;=&gt;{:pe_dir=&gt;nil, :pe_ver=&gt;nil, :pe_upgrade_dir=&gt;nil, :pe_upgrade_ver=&gt;nil, :hypervisor=&gt;&quot;vmpooler&quot;, :platform=&gt;&quot;el-7-x86_64&quot;, :template=&gt;&quot;centos-7-x86_64&quot;, :roles=&gt;[&quot;master&quot;, &quot;agent&quot;, &quot;dashboard&quot;, &quot;database&quot;, &quot;default&quot;], :host_tags=&gt;{}}}"/><property name="nfs_server" value="none"/><property name="pooling_api" value="http://vmpooler.delivery.puppetlabs.net/"/><property name="home" value="/Users/rishi.javia"/><property name="helper" value="[]"/><property name="post_suite" value="[]"/><property name="install" value="[]"/><property name="pre_cleanup" value="[]"/><property name="modules" value="[]"/><property name="logger" value="#&lt;Beaker::Logger:0x007fe451cc73a0&gt;"/><property name="timestamp" value="2017-08-08 19:25:56 -0700"/><property name="beaker_version" value="3.21.1"/><property name="log_prefix" value="centos7-pe"/><property name="xml_dated_dir" value="junit/centos7-pe/2017-08-08_19_25_56"/><property name="log_dated_dir" value="log/centos7-pe/2017-08-08_19_25_56"/><property name="logger_sut" value="#&lt;Beaker::Logger:0x007fe451cc6360&gt;"/></properties><testcase classname="tests/reports" name="cached_catalog_status_in_report.rb" time="28.837883"><system-out><![CDATA[
PUP-5867: The report specifies whether a cached catalog was used, and if so, why
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:32$ puppet master --configprint user
    puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.85 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:33$ getent passwd puppet
    puppet:x:996:994:puppetserver daemon:/opt/puppetlabs/server/data/puppetserver:/sbin/nologin
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:33$ mktemp -dt report_dir.XXXXXX
    /tmp/report_dir.IUfvvL
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:33$ chown puppet:puppet /tmp/report_dir.IUfvvL
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:33$ mktemp -dt cached_catalog_status_in_report.rb.XXXXXX
    /tmp/cached_catalog_status_in_report.rb.WJ3D8d
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  Setting curl retries to 30
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:33$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.11 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:34$ puppet master --configprint vardir
    /opt/puppetlabs/server/data/puppetserver
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:35$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:35$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    {
      "jruby-puppet": {
        "ruby-load-path": [
          "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
        ],
        "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
        "gem-path": [
          "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
          "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
        ],
        "master-conf-dir": "/etc/puppetlabs/puppet",
        "master-code-dir": "/etc/puppetlabs/code",
        "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
        "master-run-dir": "/var/run/puppetlabs/puppetserver",
        "master-log-dir": "/var/log/puppetlabs/puppetserver"
      },
      "http-client": {
      },
      "profiler": {
      }
    }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-xqnf0q centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:35$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.75 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:36$ test -e /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:36$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/cached_catalog_status_in_report.rb.WJ3D8d/puppet.conf.bak
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:36$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.85 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:37$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.78 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:38$ cat /etc/puppetlabs/puppet/puppet.conf
    # This file can be used to override the default puppet settings.
    # See the following links for more details on what settings are available:
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-bzxnf6 centos7-64-1:/tmp/cached_catalog_status_in_report.rb.WJ3D8d/puppet.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:38$ cat /etc/puppetlabs/puppet/puppet.conf
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
    
    [master]
    reportdir = /tmp/report_dir.IUfvvL
    reports = store
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:38$ service puppetserver reload
    Redirecting to /bin/systemctl reload  puppetserver.service
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.52 seconds
  
  * cached_catalog_status should be 'not used' when a new catalog is retrieved
    
    * Initial run: cache a newly retrieved catalog
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:42$ puppet agent -t --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'production'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245389'
        Notice: Applied catalog in 0.02 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.95 seconds
    
    * Run again and ensure report indicates that the cached catalog was not used
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:45$ puppet agent --onetime --no-daemonize --server y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.30 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:48$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:49$ cat /tmp/report_dir.IUfvvL/y9sqckmg348o6r5.delivery.puppetlabs.net/*
        --- !ruby/object:Puppet::Transaction::Report
        host: y9sqckmg348o6r5.delivery.puppetlabs.net
        time: '2017-08-09T02:23:10.721390748Z'
        configuration_version: 1502245391
        transaction_uuid: 28f08be5-594a-4ebd-8dd4-92e62125fcc6
        report_format: 7
        puppet_version: 5.0.1
        status: unchanged
        noop: false
        noop_pending: false
        environment: production
        logs:
        - level: notice
          message: Applied catalog in 0.02 seconds
          source: Puppet
          tags:
          - notice
          time: '2017-08-09T02:23:11.413025204Z'
          file:
          line:
        metrics:
          resources:
            name: resources
            label: Resources
            values:
            - - total
              - Total
              - 7
            - - skipped
              - Skipped
              - 0
            - - failed
              - Failed
              - 0
            - - failed_to_restart
              - Failed to restart
              - 0
            - - restarted
              - Restarted
              - 0
            - - changed
              - Changed
              - 0
            - - out_of_sync
              - Out of sync
              - 0
            - - scheduled
              - Scheduled
              - 0
            - - corrective_change
              - Corrective change
              - 0
          time:
            name: time
            label: Time
            values:
            - - schedule
              - Schedule
              - 0.000708416
            - - filebucket
              - Filebucket
              - 5.6556e-05
            - - config_retrieval
              - Config retrieval
              - 0.25757766499987156
            - - total
              - Total
              - 0.25834263699987153
          changes:
            name: changes
            label: Changes
            values:
            - - total
              - Total
              - 0
          events:
            name: events
            label: Events
            values:
            - - total
              - Total
              - 0
            - - failure
              - Failure
              - 0
            - - success
              - Success
              - 0
        resource_statuses:
          Schedule[puppet]:
            title: puppet
            file:
            line:
            resource: Schedule[puppet]
            resource_type: Schedule
            containment_path:
            - Schedule[puppet]
            evaluation_time: 6.0093e-05
            tags:
            - schedule
            - puppet
            time: '2017-08-09T02:23:11.402446239Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[hourly]:
            title: hourly
            file:
            line:
            resource: Schedule[hourly]
            resource_type: Schedule
            containment_path:
            - Schedule[hourly]
            evaluation_time: 5.1458e-05
            tags:
            - schedule
            - hourly
            time: '2017-08-09T02:23:11.403073583Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[daily]:
            title: daily
            file:
            line:
            resource: Schedule[daily]
            resource_type: Schedule
            containment_path:
            - Schedule[daily]
            evaluation_time: 4.7392e-05
            tags:
            - schedule
            - daily
            time: '2017-08-09T02:23:11.403214824Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[weekly]:
            title: weekly
            file:
            line:
            resource: Schedule[weekly]
            resource_type: Schedule
            containment_path:
            - Schedule[weekly]
            evaluation_time: 4.6594e-05
            tags:
            - schedule
            - weekly
            time: '2017-08-09T02:23:11.403348640Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[monthly]:
            title: monthly
            file:
            line:
            resource: Schedule[monthly]
            resource_type: Schedule
            containment_path:
            - Schedule[monthly]
            evaluation_time: 0.000455766
            tags:
            - schedule
            - monthly
            time: '2017-08-09T02:23:11.403489372Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[never]:
            title: never
            file:
            line:
            resource: Schedule[never]
            resource_type: Schedule
            containment_path:
            - Schedule[never]
            evaluation_time: 4.7113e-05
            tags:
            - schedule
            - never
            time: '2017-08-09T02:23:11.404031899Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Filebucket[puppet]:
            title: puppet
            file:
            line:
            resource: Filebucket[puppet]
            resource_type: Filebucket
            containment_path:
            - Filebucket[puppet]
            evaluation_time: 5.6556e-05
            tags:
            - filebucket
            - puppet
            time: '2017-08-09T02:23:11.404173640Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
        corrective_change: false
        catalog_uuid: 11f8731a-8eb0-434d-84bb-01d0b79e1cf5
        cached_catalog_status: not_used
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:49$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.87 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:50$ rm -rf /tmp/report_dir.IUfvvL/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * Run with --use_cached_catalog and ensure report indicates cached catalog was explicitly requested
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:50$ puppet agent --onetime --no-daemonize --use_cached_catalog --server y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.71 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:51$ puppet agent --configprint node_name_value
      y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.77 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:52$ cat /tmp/report_dir.IUfvvL/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:23:14.974837145Z'
      configuration_version: 1502245391
      transaction_uuid: 106e8bac-de51-42d3-b58c-2b3365cb659b
      report_format: 7
      puppet_version: 5.0.1
      status: unchanged
      noop: false
      noop_pending: false
      environment: production
      logs:
      - level: notice
        message: Applied catalog in 0.02 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:23:15.146275875Z'
        file:
        line:
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 7
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 0
          - - out_of_sync
            - Out of sync
            - 0
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 0
        time:
          name: time
          label: Time
          values:
          - - schedule
            - Schedule
            - 0.00035355300000000005
          - - filebucket
            - Filebucket
            - 6.2539e-05
          - - config_retrieval
            - Config retrieval
            - 0.012186869000061051
          - - total
            - Total
            - 0.012602961000061051
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 0
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 0
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 0
      resource_statuses:
        Schedule[puppet]:
          title: puppet
          file:
          line:
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 8.5383e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:23:15.135036578Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file:
          line:
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 4.5356e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:23:15.135206801Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file:
          line:
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 6.8583e-05
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:23:15.135367880Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file:
          line:
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 5.5113e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:23:15.135522715Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file:
          line:
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 4.5665e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:23:15.135685039Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file:
          line:
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 5.3453e-05
          tags:
          - schedule
          - never
          time: '2017-08-09T02:23:15.135812065Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file:
          line:
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 6.2539e-05
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:23:15.135966080Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: false
      catalog_uuid: 11f8731a-8eb0-434d-84bb-01d0b79e1cf5
      cached_catalog_status: explicitly_requested
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:52$ puppet agent --configprint node_name_value
      y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.81 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:53$ rm -rf /tmp/report_dir.IUfvvL/y9sqckmg348o6r5.delivery.puppetlabs.net/*
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * On a run which fails to retrieve a new catalog, ensure report indicates cached catalog was used on failure
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:53$ puppet agent --onetime --no-daemonize --report_server y9sqckmg348o6r5.delivery.puppetlabs.net --server nonexist
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.87 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:55$ puppet agent --configprint node_name_value
      y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:56$ cat /tmp/report_dir.IUfvvL/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:23:18.344564155Z'
      configuration_version: 1502245391
      transaction_uuid: 8e9cd321-9eef-49b2-acbd-6f1e6544e37b
      report_format: 7
      puppet_version: 5.0.1
      status: unchanged
      noop: false
      noop_pending: false
      environment: production
      logs:
      - level: warning
        message: 'Unable to fetch my node definition, but the agent run will continue:'
        source: Puppet
        tags:
        - warning
        time: '2017-08-09T02:23:18.377833188Z'
        file:
        line:
      - level: warning
        message: 'Failed to open TCP connection to nonexist:8140 (getaddrinfo: Name or service
          not known)'
        source: Puppet
        tags:
        - warning
        time: '2017-08-09T02:23:18.377940389Z'
        file:
        line:
      - level: err
        message: 'Failed to generate additional resources using ''eval_generate'': Failed
          to open TCP connection to nonexist:8140 (getaddrinfo: Name or service not known)'
        source: "/File[/opt/puppetlabs/puppet/cache/facts.d]"
        tags:
        - err
        - file
        - pluginfacts
        time: '2017-08-09T02:23:18.417519404Z'
        file:
        line:
      - level: err
        message: 'Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts:
          Failed to open TCP connection to nonexist:8140 (getaddrinfo: Name or service not
          known)'
        source: "/File[/opt/puppetlabs/puppet/cache/facts.d]"
        tags:
        - err
        - file
        - pluginfacts
        time: '2017-08-09T02:23:18.426025746Z'
        file:
        line:
      - level: err
        message: 'Failed to generate additional resources using ''eval_generate'': Failed
          to open TCP connection to nonexist:8140 (getaddrinfo: Name or service not known)'
        source: "/File[/opt/puppetlabs/puppet/cache/lib]"
        tags:
        - err
        - file
        - plugin
        time: '2017-08-09T02:23:18.437132215Z'
        file:
        line:
      - level: err
        message: 'Could not evaluate: Could not retrieve file metadata for puppet:///plugins:
          Failed to open TCP connection to nonexist:8140 (getaddrinfo: Name or service not
          known)'
        source: "/File[/opt/puppetlabs/puppet/cache/lib]"
        tags:
        - err
        - file
        - plugin
        time: '2017-08-09T02:23:18.445856174Z'
        file:
        line:
      - level: err
        message: 'Could not retrieve catalog from remote server: Failed to open TCP connection
          to nonexist:8140 (getaddrinfo: Name or service not known)'
        source: Puppet
        tags:
        - err
        time: '2017-08-09T02:23:18.614114780Z'
        file:
        line:
      - level: notice
        message: Applied catalog in 0.03 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:23:18.677100316Z'
        file:
        line:
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 7
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 0
          - - out_of_sync
            - Out of sync
            - 0
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 0
        time:
          name: time
          label: Time
          values:
          - - schedule
            - Schedule
            - 0.000377962
          - - filebucket
            - Filebucket
            - 6.1527e-05
          - - config_retrieval
            - Config retrieval
            - 0.0010478680001142493
          - - total
            - Total
            - 0.0014873570001142492
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 0
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 0
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 0
      resource_statuses:
        Schedule[puppet]:
          title: puppet
          file:
          line:
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 9.0437e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:23:18.661515686Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file:
          line:
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 5.4022e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:23:18.662332786Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file:
          line:
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 6.8003e-05
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:23:18.662479797Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file:
          line:
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 5.0917e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:23:18.662683870Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file:
          line:
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 5.1262e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:23:18.663384066Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file:
          line:
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 6.3321e-05
          tags:
          - schedule
          - never
          time: '2017-08-09T02:23:18.663540309Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file:
          line:
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 6.1527e-05
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:23:18.663722577Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: false
      catalog_uuid: 11f8731a-8eb0-434d-84bb-01d0b79e1cf5
      cached_catalog_status: on_failure
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:56$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.87 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:57$ if [ -f '/tmp/cached_catalog_status_in_report.rb.WJ3D8d/puppet.conf.bak' ]; then cat '/tmp/cached_catalog_status_in_report.rb.WJ3D8d/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/cached_catalog_status_in_report.rb.WJ3D8d/puppet.conf.bak'; fi
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:27:57$ service puppetserver reload
    Redirecting to /bin/systemctl reload  puppetserver.service
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.27 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:01$ rm -rf /tmp/report_dir.IUfvvL

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="corrective_change_new_resource.rb" time="19.627426"><system-out><![CDATA[
C98092 - a new resource should not be reported as a corrective change
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:01$ mkdir -p /tmp/corrective_change_new_resource_01ml3rea/manifests /tmp/corrective_change_new_resource_01ml3rea/modules; chmod -R 755 /tmp/corrective_change_new_resource_01ml3rea
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:01$ puppet agent --configprint environmentpath
    /etc/puppetlabs/code/environments
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.85 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:02$ mkdir -p /etc/puppetlabs/code/environments; ln -sf /tmp/corrective_change_new_resource_01ml3rea /etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:02$ mktemp -t corrective_change_new_resource_01ml3rea.XXXXXX
    /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * create file resource - site.pp to verify corrective change flag
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:02$ mktemp -t apply_manifest.pp.XXXXXX
      /tmp/apply_manifest.pp.m2evr6
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-hipkek centos7-64-1:/tmp/apply_manifest.pp.m2evr6 {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:02$ puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.m2evr6
      Notice: Compiled catalog for y9sqckmg348o6r5.delivery.puppetlabs.net in environment production in 0.02 seconds
      Info: Applying configuration version '1502245407'
      Notice: /Stage[main]/Main/File[/etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea/manifests/site.pp]/ensure: defined content as '{md5}e51214c8c42b61397e3afd35b2d94977'
      Notice: Applied catalog in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.60 seconds
    Exited: 2
  
  * run agent(s)
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:04$ mktemp -dt corrective_change_new_resource.rb.XXXXXX
      /tmp/corrective_change_new_resource.rb.kvRzgc
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    Setting curl retries to 30
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:04$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.91 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:05$ puppet master --configprint vardir
      /opt/puppetlabs/server/data/puppetserver
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:05$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:06$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
      {
        "jruby-puppet": {
          "ruby-load-path": [
            "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
          ],
          "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
          "gem-path": [
            "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
            "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
          ],
          "master-conf-dir": "/etc/puppetlabs/puppet",
          "master-code-dir": "/etc/puppetlabs/code",
          "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
          "master-run-dir": "/var/run/puppetlabs/puppetserver",
          "master-log-dir": "/var/log/puppetlabs/puppetserver"
        },
        "http-client": {
        },
        "profiler": {
        }
      }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-ffh0z9 centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:06$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.80 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:06$ test -e /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:07$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/corrective_change_new_resource.rb.kvRzgc/puppet.conf.bak
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:07$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:07$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:08$ cat /etc/puppetlabs/puppet/puppet.conf
      # This file can be used to override the default puppet settings.
      # See the following links for more details on what settings are available:
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-zhm2p5 centos7-64-1:/tmp/corrective_change_new_resource.rb.kvRzgc/puppet.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:08$ cat /etc/puppetlabs/puppet/puppet.conf
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:09$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.40 seconds
    
    * Run agent once to create new File resource
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:13$ puppet agent -t --environment corrective_change_new_resource_01ml3rea --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'corrective_change_new_resource_01ml3rea'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245419'
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]/content: 
        --- /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK	2017-08-09 02:23:25.957668469 +0000
        +++ /tmp/puppet-file20170809-3941-1m98u9k	2017-08-09 02:23:39.207668785 +0000
        @@ -0,0 +1 @@
        +this is a test
        
        Info: Computing checksum on file /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK
        Info: /Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]: Filebucketed /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK to puppet with sum d41d8cd98f00b204e9800998ecf8427e
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]/content: content changed '{md5}d41d8cd98f00b204e9800998ecf8427e' to '{md5}e19c1283c925b3206685ff522acfe3e6'
        Notice: Applied catalog in 0.06 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.43 seconds
      Exited: 2
    
    * Verify the file resource is created
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:15$ cat /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK
        this is a test
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:15$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.78 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:16$ if [ -f '/tmp/corrective_change_new_resource.rb.kvRzgc/puppet.conf.bak' ]; then cat '/tmp/corrective_change_new_resource.rb.kvRzgc/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/corrective_change_new_resource.rb.kvRzgc/puppet.conf.bak'; fi
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:16$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.48 seconds
  
  * Check report
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:20$ puppet config print statedir
      /opt/puppetlabs/puppet/cache/state
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.78 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:20$ cat /opt/puppetlabs/puppet/cache/state/last_run_report.yaml
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:23:38.304978857+00:00'
      configuration_version: 1502245419
      transaction_uuid: 48f60735-de40-40ce-bf54-a27437cee979
      report_format: 7
      puppet_version: 5.0.1
      status: changed
      noop: false
      noop_pending: false
      environment: corrective_change_new_resource_01ml3rea
      logs:
      - level: info
        message: Using configured environment 'corrective_change_new_resource_01ml3rea'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:38.648990384+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving pluginfacts
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:38.649333051+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving plugin
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:38.737006882+00:00'
        file: 
        line: 
      - level: info
        message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:39.151522152+00:00'
        file: 
        line: 
      - level: info
        message: Applying configuration version '1502245419'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:39.202458370+00:00'
        file: 
        line: 
      - level: notice
        message: "\n--- /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK\t2017-08-09
          02:23:25.957668469 +0000\n+++ /tmp/puppet-file20170809-3941-1m98u9k\t2017-08-09
          02:23:39.207668785 +0000\n@@ -0,0 +1 @@\n+this is a test\n"
        source: "/Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]/content"
        tags:
        - notice
        - file
        - class
        - content
        time: '2017-08-09T02:23:39.213584261+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea/manifests/site.pp"
        line: 3
      - level: info
        message: Computing checksum on file /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:39.214916824+00:00'
        file: 
        line: 
      - level: info
        message: Filebucketed /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK to puppet
          with sum d41d8cd98f00b204e9800998ecf8427e
        source: "/Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]"
        tags:
        - info
        - file
        - class
        time: '2017-08-09T02:23:39.237656430+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea/manifests/site.pp"
        line: 3
      - level: notice
        message: content changed '{md5}d41d8cd98f00b204e9800998ecf8427e' to '{md5}e19c1283c925b3206685ff522acfe3e6'
        source: "/Stage[main]/Main/File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]/content"
        tags:
        - notice
        - file
        - class
        time: '2017-08-09T02:23:39.244357112+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea/manifests/site.pp"
        line: 3
      - level: notice
        message: Applied catalog in 0.06 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:23:39.257446156+00:00'
        file: 
        line: 
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 8
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 1
          - - out_of_sync
            - Out of sync
            - 1
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 0
        time:
          name: time
          label: Time
          values:
          - - file
            - File
            - 0.036079784
          - - schedule
            - Schedule
            - 0.000309074
          - - filebucket
            - Filebucket
            - 6.8321e-05
          - - config_retrieval
            - Config retrieval
            - 0.2284010619998753
          - - total
            - Total
            - 0.2648582409998753
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 1
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 1
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 1
      resource_statuses:
        File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]:
          title: "/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK"
          file: "/etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea/manifests/site.pp"
          line: 3
          resource: File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]
          resource_type: File
          containment_path:
          - Stage[main]
          - Main
          - File[/tmp/corrective_change_new_resource_01ml3rea.b3ZJkK]
          evaluation_time: 0.036079784
          tags:
          - file
          - class
          time: '2017-08-09T02:23:39.208428188+00:00'
          failed: false
          changed: true
          out_of_sync: true
          skipped: false
          change_count: 1
          out_of_sync_count: 1
          events:
          - audited: false
            property: content
            previous_value: "{md5}d41d8cd98f00b204e9800998ecf8427e"
            desired_value: "{md5}e19c1283c925b3206685ff522acfe3e6"
            historical_value: 
            message: content changed '{md5}d41d8cd98f00b204e9800998ecf8427e' to '{md5}e19c1283c925b3206685ff522acfe3e6'
            name: content_changed
            status: success
            time: '2017-08-09T02:23:39.214620173+00:00'
            redacted: 
            corrective_change: false
          corrective_change: false
        Schedule[puppet]:
          title: puppet
          file: 
          line: 
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 6.7655e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:23:39.245295932+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file: 
          line: 
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 4.9756e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:23:39.245473143+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file: 
          line: 
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 4.9411e-05
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:23:39.245627928+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file: 
          line: 
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 4.7344e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:23:39.245762119+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file: 
          line: 
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 4.817e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:23:39.245918638+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file: 
          line: 
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 4.6738e-05
          tags:
          - schedule
          - never
          time: '2017-08-09T02:23:39.246049928+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file: 
          line: 
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 6.8321e-05
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:23:39.246192224+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: false
      catalog_uuid: ff90a92e-8207-4771-bf4e-535e648e6a7e
      cached_catalog_status: not_used
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.07 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ rm -rf /etc/puppetlabs/code/environments/corrective_change_new_resource_01ml3rea

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

* clean out produced resources
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ rm /tmp/corrective_change_new_resource_01ml3rea.b3ZJkK
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="corrective_change_outside_puppet.rb" time="20.703779"><system-out><![CDATA[
C98093 - a resource changed outside of Puppet will be reported as a corrective change
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ mkdir -p /tmp/corrective_change_outside_puppet_513fjdmc/manifests /tmp/corrective_change_outside_puppet_513fjdmc/modules; chmod -R 755 /tmp/corrective_change_outside_puppet_513fjdmc
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ mkdir -p /etc/puppetlabs/code/environments; ln -sf /tmp/corrective_change_outside_puppet_513fjdmc /etc/puppetlabs/code/environments/corrective_change_outside_puppet_513fjdmc
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ mktemp -t corrective_change_outside_puppet_513fjdmc.XXXXXX
    /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * create file resource - site.pp to verify corrective change flag
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ mktemp -t apply_manifest.pp.XXXXXX
      /tmp/apply_manifest.pp.y2hBOF
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1x70m35 centos7-64-1:/tmp/apply_manifest.pp.y2hBOF {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:21$ puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.y2hBOF
      Notice: Compiled catalog for y9sqckmg348o6r5.delivery.puppetlabs.net in environment production in 0.02 seconds
      Info: Applying configuration version '1502245426'
      Notice: /Stage[main]/Main/File[/etc/puppetlabs/code/environments/corrective_change_outside_puppet_513fjdmc/manifests/site.pp]/ensure: defined content as '{md5}a2aa3cc6162c74ddf989eddade3af057'
      Notice: Applied catalog in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.60 seconds
    Exited: 2
  
  * run agent(s)
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:22$ mktemp -dt corrective_change_outside_puppet.rb.XXXXXX
      /tmp/corrective_change_outside_puppet.rb.sQ6s4z
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    Setting curl retries to 30
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:22$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.89 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:23$ puppet master --configprint vardir
      /opt/puppetlabs/server/data/puppetserver
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:24$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:24$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
      {
        "jruby-puppet": {
          "ruby-load-path": [
            "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
          ],
          "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
          "gem-path": [
            "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
            "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
          ],
          "master-conf-dir": "/etc/puppetlabs/puppet",
          "master-code-dir": "/etc/puppetlabs/code",
          "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
          "master-run-dir": "/var/run/puppetlabs/puppetserver",
          "master-log-dir": "/var/log/puppetlabs/puppetserver"
        },
        "http-client": {
        },
        "profiler": {
        }
      }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-piv3d9 centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:24$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.95 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:25$ test -e /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:25$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/corrective_change_outside_puppet.rb.sQ6s4z/puppet.conf.bak
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:25$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.95 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:26$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:27$ cat /etc/puppetlabs/puppet/puppet.conf
      # This file can be used to override the default puppet settings.
      # See the following links for more details on what settings are available:
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1aulw4c centos7-64-1:/tmp/corrective_change_outside_puppet.rb.sQ6s4z/puppet.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:28$ cat /etc/puppetlabs/puppet/puppet.conf
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:28$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.20 seconds
    
    * Run agent once to create new File resource
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:31$ puppet agent -t --environment corrective_change_outside_puppet_513fjdmc --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'corrective_change_outside_puppet_513fjdmc'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245436'
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]/content: 
        --- /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7	2017-08-09 02:23:44.723668917 +0000
        +++ /tmp/puppet-file20170809-4338-1y481bc	2017-08-09 02:23:56.852669206 +0000
        @@ -0,0 +1 @@
        +this is a test
        
        Info: Computing checksum on file /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
        Info: FileBucket got a duplicate file {md5}d41d8cd98f00b204e9800998ecf8427e
        Info: /Stage[main]/Main/File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]: Filebucketed /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7 to puppet with sum d41d8cd98f00b204e9800998ecf8427e
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]/content: content changed '{md5}d41d8cd98f00b204e9800998ecf8427e' to '{md5}e19c1283c925b3206685ff522acfe3e6'
        Notice: Applied catalog in 0.06 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.27 seconds
      Exited: 2
    
    * Verify the file resource is created
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:33$ cat /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
        this is a test
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    * Delete the file
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:33$ rm /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    * Run agent to correct the files absence
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:33$ puppet agent -t --environment corrective_change_outside_puppet_513fjdmc --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'corrective_change_outside_puppet_513fjdmc'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245439'
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]/ensure: defined content as '{md5}e19c1283c925b3206685ff522acfe3e6'
        Notice: Applied catalog in 0.03 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.11 seconds
      Exited: 2
    
    * Verify the file resource is created
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:35$ cat /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
        this is a test
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:35$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.75 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:36$ if [ -f '/tmp/corrective_change_outside_puppet.rb.sQ6s4z/puppet.conf.bak' ]; then cat '/tmp/corrective_change_outside_puppet.rb.sQ6s4z/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/corrective_change_outside_puppet.rb.sQ6s4z/puppet.conf.bak'; fi
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:36$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.21 seconds
  
  * Check report
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:40$ puppet config print statedir
      /opt/puppetlabs/puppet/cache/state
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.94 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ cat /opt/puppetlabs/puppet/cache/state/last_run_report.yaml
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:23:58.464282004+00:00'
      configuration_version: 1502245439
      transaction_uuid: d2bd8df9-0f20-414e-83fc-d48bf55c27ed
      report_format: 7
      puppet_version: 5.0.1
      status: changed
      noop: false
      noop_pending: false
      environment: corrective_change_outside_puppet_513fjdmc
      logs:
      - level: info
        message: Using configured environment 'corrective_change_outside_puppet_513fjdmc'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:58.680243844+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving pluginfacts
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:58.680614175+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving plugin
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:58.734051591+00:00'
        file: 
        line: 
      - level: info
        message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:59.070431366+00:00'
        file: 
        line: 
      - level: info
        message: Applying configuration version '1502245439'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:23:59.111630763+00:00'
        file: 
        line: 
      - level: notice
        message: defined content as '{md5}e19c1283c925b3206685ff522acfe3e6'
        source: "/Stage[main]/Main/File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]/ensure"
        tags:
        - notice
        - file
        - class
        time: '2017-08-09T02:23:59.119670164+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_outside_puppet_513fjdmc/manifests/site.pp"
        line: 3
      - level: notice
        message: Applied catalog in 0.03 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:23:59.134560992+00:00'
        file: 
        line: 
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 8
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 1
          - - out_of_sync
            - Out of sync
            - 1
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 1
        time:
          name: time
          label: Time
          values:
          - - file
            - File
            - 0.004992148
          - - schedule
            - Schedule
            - 0.000440809
          - - filebucket
            - Filebucket
            - 0.000120191
          - - config_retrieval
            - Config retrieval
            - 0.17788271600011285
          - - total
            - Total
            - 0.18343586400011286
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 1
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 1
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 1
      resource_statuses:
        File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]:
          title: "/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7"
          file: "/etc/puppetlabs/code/environments/corrective_change_outside_puppet_513fjdmc/manifests/site.pp"
          line: 3
          resource: File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]
          resource_type: File
          containment_path:
          - Stage[main]
          - Main
          - File[/tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7]
          evaluation_time: 0.004992148
          tags:
          - file
          - class
          time: '2017-08-09T02:23:59.114829989+00:00'
          failed: false
          changed: true
          out_of_sync: true
          skipped: false
          change_count: 1
          out_of_sync_count: 1
          events:
          - audited: false
            property: ensure
            previous_value: absent
            desired_value: file
            historical_value: 
            message: defined content as '{md5}e19c1283c925b3206685ff522acfe3e6'
            name: file_created
            status: success
            time: '2017-08-09T02:23:59.115264178+00:00'
            redacted: 
            corrective_change: true
          corrective_change: true
        Schedule[puppet]:
          title: puppet
          file: 
          line: 
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 8.3856e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:23:59.120628366+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file: 
          line: 
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 6.7239e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:23:59.120819872+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file: 
          line: 
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 6.6196e-05
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:23:59.121026550+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file: 
          line: 
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 8.1725e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:23:59.121220562+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file: 
          line: 
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 5.941e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:23:59.121428336+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file: 
          line: 
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 8.2383e-05
          tags:
          - schedule
          - never
          time: '2017-08-09T02:23:59.121598541+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file: 
          line: 
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 0.000120191
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:23:59.121787100+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: true
      catalog_uuid: 9d4bc1ed-2523-4593-99b9-9f86c84f815b
      cached_catalog_status: not_used
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ rm -rf /etc/puppetlabs/code/environments/corrective_change_outside_puppet_513fjdmc

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

* clean out produced resources
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ rm /tmp/corrective_change_outside_puppet_513fjdmc.GlOnn7
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="corrective_change_via_puppet.rb" time="22.733127"><system-out><![CDATA[
C98094 - a resource changed via Puppet manifest will not be reported as a corrective change
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ mkdir -p /tmp/corrective_change_via_puppet_mytnsgwl/manifests /tmp/corrective_change_via_puppet_mytnsgwl/modules; chmod -R 755 /tmp/corrective_change_via_puppet_mytnsgwl
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ mkdir -p /etc/puppetlabs/code/environments; ln -sf /tmp/corrective_change_via_puppet_mytnsgwl /etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ mktemp -t corrective_change_via_puppet_mytnsgwl.XXXXXX
    /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * create file resource in site.pp
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:41$ mktemp -t apply_manifest.pp.XXXXXX
      /tmp/apply_manifest.pp.2ZNVYW
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1eqzboz centos7-64-1:/tmp/apply_manifest.pp.2ZNVYW {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:42$ puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.2ZNVYW
      Notice: Compiled catalog for y9sqckmg348o6r5.delivery.puppetlabs.net in environment production in 0.02 seconds
      Info: Applying configuration version '1502245446'
      Notice: /Stage[main]/Main/File[/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp]/ensure: defined content as '{md5}452db7b976582d9f2fa0147f4696dd13'
      Notice: Applied catalog in 0.04 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.51 seconds
    Exited: 2
  
  * run agent(s) to create the new resource
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:43$ mktemp -dt corrective_change_via_puppet.rb.XXXXXX
      /tmp/corrective_change_via_puppet.rb.vlV7VT
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    Setting curl retries to 30
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:43$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.85 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:44$ puppet master --configprint vardir
      /opt/puppetlabs/server/data/puppetserver
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:45$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:45$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
      {
        "jruby-puppet": {
          "ruby-load-path": [
            "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
          ],
          "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
          "gem-path": [
            "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
            "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
          ],
          "master-conf-dir": "/etc/puppetlabs/puppet",
          "master-code-dir": "/etc/puppetlabs/code",
          "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
          "master-run-dir": "/var/run/puppetlabs/puppetserver",
          "master-log-dir": "/var/log/puppetlabs/puppetserver"
        },
        "http-client": {
        },
        "profiler": {
        }
      }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-6u2x5b centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:45$ puppet master --configprint confdir
      /etc/puppetlabs/puppet
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.78 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:46$ test -e /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:46$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/corrective_change_via_puppet.rb.vlV7VT/puppet.conf.bak
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:46$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.77 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:47$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.97 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:48$ cat /etc/puppetlabs/puppet/puppet.conf
      # This file can be used to override the default puppet settings.
      # See the following links for more details on what settings are available:
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
      # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-hxi54c centos7-64-1:/tmp/corrective_change_via_puppet.rb.vlV7VT/puppet.conf {:ignore => }
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:48$ cat /etc/puppetlabs/puppet/puppet.conf
      [master]
      vardir = /opt/puppetlabs/server/data/puppetserver
      logdir = /var/log/puppetlabs/puppetserver
      rundir = /var/run/puppetlabs/puppetserver
      pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
      codedir = /etc/puppetlabs/code
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:48$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.47 seconds
    
    * Run agent once to create new File resource
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:51$ puppet agent -t --environment corrective_change_via_puppet_mytnsgwl --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'corrective_change_via_puppet_mytnsgwl'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245457'
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content: 
        --- /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb	2017-08-09 02:24:05.431669411 +0000
        +++ /tmp/puppet-file20170809-4793-oinbel	2017-08-09 02:24:17.604669701 +0000
        @@ -0,0 +1 @@
        +this is my original important data
        
        Info: Computing checksum on file /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
        Info: FileBucket got a duplicate file {md5}d41d8cd98f00b204e9800998ecf8427e
        Info: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]: Filebucketed /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb to puppet with sum d41d8cd98f00b204e9800998ecf8427e
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content: content changed '{md5}d41d8cd98f00b204e9800998ecf8427e' to '{md5}3af9ddea1d789f7cf98376a444fe52ea'
        Notice: Applied catalog in 0.07 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.47 seconds
      Exited: 2
    
    * Verify the file resource is created
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:54$ cat /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
        this is my original important data
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    * Change the manifest for the resource
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:54$ mktemp -t apply_manifest.pp.XXXXXX
        /tmp/apply_manifest.pp.q7zSCi
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
      localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-113cwbt centos7-64-1:/tmp/apply_manifest.pp.q7zSCi {:ignore => }
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:54$ puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.q7zSCi
        Notice: Compiled catalog for y9sqckmg348o6r5.delivery.puppetlabs.net in environment production in 0.03 seconds
        Info: Applying configuration version '1502245459'
        Info: Computing checksum on file /etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp
        Info: /Stage[main]/Main/File[/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp]: Filebucketed /etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp to puppet with sum 452db7b976582d9f2fa0147f4696dd13
        Notice: /Stage[main]/Main/File[/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp]/content: content changed '{md5}452db7b976582d9f2fa0147f4696dd13' to '{md5}6089fe3c2bdf1be16283c401f7c5528c'
        Notice: Applied catalog in 0.03 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.66 seconds
      Exited: 2
    
    * Run agent a 2nd time to change the File resource
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:56$ puppet agent -t --environment corrective_change_via_puppet_mytnsgwl --server y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Using configured environment 'corrective_change_via_puppet_mytnsgwl'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245461'
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content: 
        --- /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb	2017-08-09 02:24:17.645669702 +0000
        +++ /tmp/puppet-file20170809-4903-xvqo64	2017-08-09 02:24:21.613669796 +0000
        @@ -1 +1 @@
        -this is my original important data
        +this is my modified important data
        
        Info: Computing checksum on file /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
        Info: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]: Filebucketed /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb to puppet with sum 3af9ddea1d789f7cf98376a444fe52ea
        Notice: /Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content: content changed '{md5}3af9ddea1d789f7cf98376a444fe52ea' to '{md5}e3a5fb22e6df3b9ccb5786b516bdff57'
        Notice: Applied catalog in 0.07 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.10 seconds
      Exited: 2
    
    * Verify the file resource is created
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:58$ cat /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
        this is my modified important data
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:58$ puppet master --configprint config
      /etc/puppetlabs/puppet/puppet.conf
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.75 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:59$ if [ -f '/tmp/corrective_change_via_puppet.rb.vlV7VT/puppet.conf.bak' ]; then cat '/tmp/corrective_change_via_puppet.rb.vlV7VT/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/corrective_change_via_puppet.rb.vlV7VT/puppet.conf.bak'; fi
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:28:59$ service puppetserver reload
      Redirecting to /bin/systemctl reload  puppetserver.service
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.44 seconds
  
  * Check report
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:03$ puppet config print statedir
      /opt/puppetlabs/puppet/cache/state
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:04$ cat /opt/puppetlabs/puppet/cache/state/last_run_report.yaml
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:24:21.046620831+00:00'
      configuration_version: 1502245461
      transaction_uuid: 3fcfb2d5-48b2-41f8-a7e2-614407926b85
      report_format: 7
      puppet_version: 5.0.1
      status: changed
      noop: false
      noop_pending: false
      environment: corrective_change_via_puppet_mytnsgwl
      logs:
      - level: info
        message: Using configured environment 'corrective_change_via_puppet_mytnsgwl'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.206955582+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving pluginfacts
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.207277635+00:00'
        file: 
        line: 
      - level: info
        message: Retrieving plugin
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.262202749+00:00'
        file: 
        line: 
      - level: info
        message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.565434790+00:00'
        file: 
        line: 
      - level: info
        message: Applying configuration version '1502245461'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.611413762+00:00'
        file: 
        line: 
      - level: notice
        message: "\n--- /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb\t2017-08-09 02:24:17.645669702
          +0000\n+++ /tmp/puppet-file20170809-4903-xvqo64\t2017-08-09 02:24:21.613669796
          +0000\n@@ -1 +1 @@\n-this is my original important data\n+this is my modified
          important data\n"
        source: "/Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content"
        tags:
        - notice
        - file
        - class
        - content
        time: '2017-08-09T02:24:21.618886030+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp"
        line: 3
      - level: info
        message: Computing checksum on file /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:24:21.619975371+00:00'
        file: 
        line: 
      - level: info
        message: Filebucketed /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb to puppet
          with sum 3af9ddea1d789f7cf98376a444fe52ea
        source: "/Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]"
        tags:
        - info
        - file
        - class
        time: '2017-08-09T02:24:21.653475803+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp"
        line: 3
      - level: notice
        message: content changed '{md5}3af9ddea1d789f7cf98376a444fe52ea' to '{md5}e3a5fb22e6df3b9ccb5786b516bdff57'
        source: "/Stage[main]/Main/File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]/content"
        tags:
        - notice
        - file
        - class
        time: '2017-08-09T02:24:21.660977960+00:00'
        file: "/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp"
        line: 3
      - level: notice
        message: Applied catalog in 0.07 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:24:21.673815568+00:00'
        file: 
        line: 
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 8
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 1
          - - out_of_sync
            - Out of sync
            - 1
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 0
        time:
          name: time
          label: Time
          values:
          - - file
            - File
            - 0.046341272
          - - schedule
            - Schedule
            - 0.00036638199999999995
          - - filebucket
            - Filebucket
            - 6.7781e-05
          - - config_retrieval
            - Config retrieval
            - 0.13948733699999138
          - - total
            - Total
            - 0.1862627719999914
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 1
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 1
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 1
      resource_statuses:
        File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]:
          title: "/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb"
          file: "/etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl/manifests/site.pp"
          line: 3
          resource: File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]
          resource_type: File
          containment_path:
          - Stage[main]
          - Main
          - File[/tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb]
          evaluation_time: 0.046341272
          tags:
          - file
          - class
          time: '2017-08-09T02:24:21.614795340+00:00'
          failed: false
          changed: true
          out_of_sync: true
          skipped: false
          change_count: 1
          out_of_sync_count: 1
          events:
          - audited: false
            property: content
            previous_value: "{md5}3af9ddea1d789f7cf98376a444fe52ea"
            desired_value: "{md5}e3a5fb22e6df3b9ccb5786b516bdff57"
            historical_value: 
            message: content changed '{md5}3af9ddea1d789f7cf98376a444fe52ea' to '{md5}e3a5fb22e6df3b9ccb5786b516bdff57'
            name: content_changed
            status: success
            time: '2017-08-09T02:24:21.619489312+00:00'
            redacted: 
            corrective_change: false
          corrective_change: false
        Schedule[puppet]:
          title: puppet
          file: 
          line: 
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 7.7212e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:24:21.661953356+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file: 
          line: 
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 6.0885e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:24:21.662120803+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file: 
          line: 
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 4.786e-05
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:24:21.662300012+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file: 
          line: 
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 6.2748e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:24:21.662433052+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file: 
          line: 
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 6.9718e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:24:21.662613653+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file: 
          line: 
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 4.7959e-05
          tags:
          - schedule
          - never
          time: '2017-08-09T02:24:21.662784963+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file: 
          line: 
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 6.7781e-05
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:24:21.662941352+00:00'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: false
      catalog_uuid: d5e445e9-f53b-4c87-8c4c-406867b79b85
      cached_catalog_status: not_used
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:04$ rm -rf /etc/puppetlabs/code/environments/corrective_change_via_puppet_mytnsgwl

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

* clean out produced resources
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:04$ rm /tmp/corrective_change_via_puppet_mytnsgwl.yYMQrb
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="failover_master.rb" time="60.433516"><system-out><![CDATA[
The report specifies which master was contacted during failover
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:04$ puppet master --configprint user
    puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.80 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:05$ getent passwd puppet
    puppet:x:996:994:puppetserver daemon:/opt/puppetlabs/server/data/puppetserver:/sbin/nologin
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:05$ mktemp -dt report_dir.XXXXXX
    /tmp/report_dir.H3R3lK
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:05$ chown puppet:puppet /tmp/report_dir.H3R3lK
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:05$ mktemp -dt failover_master.rb.XXXXXX
    /tmp/failover_master.rb.PEzS5I
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  Setting curl retries to 30
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:05$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.79 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:06$ puppet master --configprint vardir
    /opt/puppetlabs/server/data/puppetserver
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.87 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:07$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:07$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
    {
      "jruby-puppet": {
        "ruby-load-path": [
          "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
        ],
        "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
        "gem-path": [
          "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
          "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
        ],
        "master-conf-dir": "/etc/puppetlabs/puppet",
        "master-code-dir": "/etc/puppetlabs/code",
        "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
        "master-run-dir": "/var/run/puppetlabs/puppetserver",
        "master-log-dir": "/var/log/puppetlabs/puppetserver"
      },
      "http-client": {
      },
      "profiler": {
      }
    }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-6cb8q4 centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:07$ puppet master --configprint confdir
    /etc/puppetlabs/puppet
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.78 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:08$ test -e /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:08$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/failover_master.rb.PEzS5I/puppet.conf.bak
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:08$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.76 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:08$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.02 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:09$ cat /etc/puppetlabs/puppet/puppet.conf
    # This file can be used to override the default puppet settings.
    # See the following links for more details on what settings are available:
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
    # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
  localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-p6bty1 centos7-64-1:/tmp/failover_master.rb.PEzS5I/puppet.conf {:ignore => }
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:10$ cat /etc/puppetlabs/puppet/puppet.conf
    [master]
    vardir = /opt/puppetlabs/server/data/puppetserver
    logdir = /var/log/puppetlabs/puppetserver
    rundir = /var/run/puppetlabs/puppetserver
    pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
    codedir = /etc/puppetlabs/code
    
    [master]
    reportdir = /tmp/report_dir.H3R3lK
    reports = store
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:10$ service puppetserver reload
    Redirecting to /bin/systemctl reload  puppetserver.service
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.24 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:13$ mktemp -t puppet_conf_test.XXXXXX
    /tmp/puppet_conf_test.nzxeAM
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * master_used field should be the name and port of the successfully contacted master when failover is active
    
    * no failover, successfully contact first master in the list
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:13$ puppet agent -t --config /tmp/puppet_conf_test.nzxeAM --server_list=y9sqckmg348o6r5.delivery.puppetlabs.net:8140,badmaster:22
        Info: Using configured environment 'production'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245479'
        Notice: Applied catalog in 0.02 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.78 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:16$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.08 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:17$ cat /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
        --- !ruby/object:Puppet::Transaction::Report
        host: y9sqckmg348o6r5.delivery.puppetlabs.net
        time: '2017-08-09T02:24:38.815592352Z'
        configuration_version: 1502245479
        transaction_uuid: 1bba4a1e-e69e-4e9f-84e6-7da5104794b8
        report_format: 7
        puppet_version: 5.0.1
        status: unchanged
        noop: false
        noop_pending: false
        environment: production
        logs:
        - level: info
          message: Using configured environment 'production'
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:39.206308310Z'
          file:
          line:
        - level: info
          message: Retrieving pluginfacts
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:39.206673676Z'
          file:
          line:
        - level: info
          message: Retrieving plugin
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:39.272700072Z'
          file:
          line:
        - level: info
          message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:39.605577411Z'
          file:
          line:
        - level: info
          message: Applying configuration version '1502245479'
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:39.656666361Z'
          file:
          line:
        - level: notice
          message: Applied catalog in 0.02 seconds
          source: Puppet
          tags:
          - notice
          time: '2017-08-09T02:24:39.674693188Z'
          file:
          line:
        metrics:
          resources:
            name: resources
            label: Resources
            values:
            - - total
              - Total
              - 7
            - - skipped
              - Skipped
              - 0
            - - failed
              - Failed
              - 0
            - - failed_to_restart
              - Failed to restart
              - 0
            - - restarted
              - Restarted
              - 0
            - - changed
              - Changed
              - 0
            - - out_of_sync
              - Out of sync
              - 0
            - - scheduled
              - Scheduled
              - 0
            - - corrective_change
              - Corrective change
              - 0
          time:
            name: time
            label: Time
            values:
            - - schedule
              - Schedule
              - 0.00036736399999999996
            - - filebucket
              - Filebucket
              - 6.5283e-05
            - - config_retrieval
              - Config retrieval
              - 0.16913629200007563
            - - total
              - Total
              - 0.16956893900007564
          changes:
            name: changes
            label: Changes
            values:
            - - total
              - Total
              - 0
          events:
            name: events
            label: Events
            values:
            - - total
              - Total
              - 0
            - - failure
              - Failure
              - 0
            - - success
              - Success
              - 0
        resource_statuses:
          Schedule[puppet]:
            title: puppet
            file:
            line:
            resource: Schedule[puppet]
            resource_type: Schedule
            containment_path:
            - Schedule[puppet]
            evaluation_time: 7.1711e-05
            tags:
            - schedule
            - puppet
            time: '2017-08-09T02:24:39.659710912Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[hourly]:
            title: hourly
            file:
            line:
            resource: Schedule[hourly]
            resource_type: Schedule
            containment_path:
            - Schedule[hourly]
            evaluation_time: 6.696e-05
            tags:
            - schedule
            - hourly
            time: '2017-08-09T02:24:39.659883848Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[daily]:
            title: daily
            file:
            line:
            resource: Schedule[daily]
            resource_type: Schedule
            containment_path:
            - Schedule[daily]
            evaluation_time: 5.1294e-05
            tags:
            - schedule
            - daily
            time: '2017-08-09T02:24:39.660963651Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[weekly]:
            title: weekly
            file:
            line:
            resource: Schedule[weekly]
            resource_type: Schedule
            containment_path:
            - Schedule[weekly]
            evaluation_time: 4.7935e-05
            tags:
            - schedule
            - weekly
            time: '2017-08-09T02:24:39.661103528Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[monthly]:
            title: monthly
            file:
            line:
            resource: Schedule[monthly]
            resource_type: Schedule
            containment_path:
            - Schedule[monthly]
            evaluation_time: 8.365e-05
            tags:
            - schedule
            - monthly
            time: '2017-08-09T02:24:39.661236737Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[never]:
            title: never
            file:
            line:
            resource: Schedule[never]
            resource_type: Schedule
            containment_path:
            - Schedule[never]
            evaluation_time: 4.5814e-05
            tags:
            - schedule
            - never
            time: '2017-08-09T02:24:39.661404503Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Filebucket[puppet]:
            title: puppet
            file:
            line:
            resource: Filebucket[puppet]
            resource_type: Filebucket
            containment_path:
            - Filebucket[puppet]
            evaluation_time: 6.5283e-05
            tags:
            - filebucket
            - puppet
            time: '2017-08-09T02:24:39.661601991Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
        corrective_change: false
        master_used: y9sqckmg348o6r5.delivery.puppetlabs.net:8140
        catalog_uuid: 62d6b2db-3833-4de7-9122-9b7c80307eb8
        cached_catalog_status: not_used
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:17$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.96 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:18$ rm -rf /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    * failover occurred, successfully report contact with first viable master
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:18$ puppet agent -t --config /tmp/puppet_conf_test.nzxeAM --server_list=badmaster:22,y9sqckmg348o6r5.delivery.puppetlabs.net:8140
        Info: Using configured environment 'production'
        Info: Retrieving pluginfacts
        Info: Retrieving plugin
        Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        Info: Applying configuration version '1502245484'
        Notice: Applied catalog in 0.03 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.43 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:20$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.14 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:21$ cat /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
        --- !ruby/object:Puppet::Transaction::Report
        host: y9sqckmg348o6r5.delivery.puppetlabs.net
        time: '2017-08-09T02:24:43.557318605Z'
        configuration_version: 1502245484
        transaction_uuid: 6f2989aa-180a-44d8-8c2e-fae642593840
        report_format: 7
        puppet_version: 5.0.1
        status: unchanged
        noop: false
        noop_pending: false
        environment: production
        logs:
        - level: info
          message: Using configured environment 'production'
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:43.771135371Z'
          file:
          line:
        - level: info
          message: Retrieving pluginfacts
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:43.771493038Z'
          file:
          line:
        - level: info
          message: Retrieving plugin
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:43.843148395Z'
          file:
          line:
        - level: info
          message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:44.143284907Z'
          file:
          line:
        - level: info
          message: Applying configuration version '1502245484'
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:44.198513990Z'
          file:
          line:
        - level: notice
          message: Applied catalog in 0.03 seconds
          source: Puppet
          tags:
          - notice
          time: '2017-08-09T02:24:44.221829372Z'
          file:
          line:
        metrics:
          resources:
            name: resources
            label: Resources
            values:
            - - total
              - Total
              - 7
            - - skipped
              - Skipped
              - 0
            - - failed
              - Failed
              - 0
            - - failed_to_restart
              - Failed to restart
              - 0
            - - restarted
              - Restarted
              - 0
            - - changed
              - Changed
              - 0
            - - out_of_sync
              - Out of sync
              - 0
            - - scheduled
              - Scheduled
              - 0
            - - corrective_change
              - Corrective change
              - 0
          time:
            name: time
            label: Time
            values:
            - - schedule
              - Schedule
              - 0.000357065
            - - filebucket
              - Filebucket
              - 6.3513e-05
            - - config_retrieval
              - Config retrieval
              - 0.12121857699980865
            - - total
              - Total
              - 0.12163915499980865
          changes:
            name: changes
            label: Changes
            values:
            - - total
              - Total
              - 0
          events:
            name: events
            label: Events
            values:
            - - total
              - Total
              - 0
            - - failure
              - Failure
              - 0
            - - success
              - Success
              - 0
        resource_statuses:
          Schedule[puppet]:
            title: puppet
            file:
            line:
            resource: Schedule[puppet]
            resource_type: Schedule
            containment_path:
            - Schedule[puppet]
            evaluation_time: 7.2041e-05
            tags:
            - schedule
            - puppet
            time: '2017-08-09T02:24:44.205151369Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[hourly]:
            title: hourly
            file:
            line:
            resource: Schedule[hourly]
            resource_type: Schedule
            containment_path:
            - Schedule[hourly]
            evaluation_time: 6.1809e-05
            tags:
            - schedule
            - hourly
            time: '2017-08-09T02:24:44.205323067Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[daily]:
            title: daily
            file:
            line:
            resource: Schedule[daily]
            resource_type: Schedule
            containment_path:
            - Schedule[daily]
            evaluation_time: 4.9356e-05
            tags:
            - schedule
            - daily
            time: '2017-08-09T02:24:44.205505969Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[weekly]:
            title: weekly
            file:
            line:
            resource: Schedule[weekly]
            resource_type: Schedule
            containment_path:
            - Schedule[weekly]
            evaluation_time: 6.4e-05
            tags:
            - schedule
            - weekly
            time: '2017-08-09T02:24:44.205672366Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[monthly]:
            title: monthly
            file:
            line:
            resource: Schedule[monthly]
            resource_type: Schedule
            containment_path:
            - Schedule[monthly]
            evaluation_time: 6.2391e-05
            tags:
            - schedule
            - monthly
            time: '2017-08-09T02:24:44.205831248Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Schedule[never]:
            title: never
            file:
            line:
            resource: Schedule[never]
            resource_type: Schedule
            containment_path:
            - Schedule[never]
            evaluation_time: 4.7468e-05
            tags:
            - schedule
            - never
            time: '2017-08-09T02:24:44.206013868Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
          Filebucket[puppet]:
            title: puppet
            file:
            line:
            resource: Filebucket[puppet]
            resource_type: Filebucket
            containment_path:
            - Filebucket[puppet]
            evaluation_time: 6.3513e-05
            tags:
            - filebucket
            - puppet
            time: '2017-08-09T02:24:44.206173168Z'
            failed: false
            changed: false
            out_of_sync: false
            skipped: false
            change_count: 0
            out_of_sync_count: 0
            events: []
            corrective_change: false
        corrective_change: false
        master_used: y9sqckmg348o6r5.delivery.puppetlabs.net:8140
        catalog_uuid: 3c4474d2-da8a-4058-99e7-035ade42ec0b
        cached_catalog_status: not_used
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:21$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.87 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:22$ rm -rf /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
    
    * master_field should not appear when no master could be conatacted
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:22$ puppet agent -t --config /tmp/puppet_conf_test.nzxeAM --server_list=badmaster:1 --http_connect_timeout=5s --report_server=y9sqckmg348o6r5.delivery.puppetlabs.net
        Warning: Could not select a functional puppet master
        Warning: Unable to fetch my node definition, but the agent run will continue:
        Warning: execution expired
        Info: Retrieving pluginfacts
        Error: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using 'eval_generate': execution expired
        Info: Retrieving plugin
        Error: /File[/opt/puppetlabs/puppet/cache/facts.d]: Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts: execution expired
        Error: /File[/opt/puppetlabs/puppet/cache/lib]: Failed to generate additional resources using 'eval_generate': execution expired
        Error: /File[/opt/puppetlabs/puppet/cache/lib]: Could not evaluate: Could not retrieve file metadata for puppet:///plugins: execution expired
        Error: Could not retrieve catalog from remote server: execution expired
        Warning: Not using cache on failed catalog
        Error: Could not retrieve catalog; skipping run
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 31.92 seconds
      Exited: 1
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:54$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:55$ cat /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
        --- !ruby/object:Puppet::Transaction::Report
        host: y9sqckmg348o6r5.delivery.puppetlabs.net
        time: '2017-08-09T02:24:47.852679537Z'
        configuration_version:
        transaction_uuid: 78e59eca-407d-43fe-bf9d-74603d7cbed3
        report_format: 7
        puppet_version: 5.0.1
        status: failed
        noop: false
        noop_pending: false
        environment: production
        logs:
        - level: warning
          message: Could not select a functional puppet master
          source: Puppet
          tags:
          - warning
          time: '2017-08-09T02:24:47.887194487Z'
          file:
          line:
        - level: warning
          message: 'Unable to fetch my node definition, but the agent run will continue:'
          source: Puppet
          tags:
          - warning
          time: '2017-08-09T02:24:52.892686352Z'
          file:
          line:
        - level: warning
          message: execution expired
          source: Puppet
          tags:
          - warning
          time: '2017-08-09T02:24:52.892811251Z'
          file:
          line:
        - level: info
          message: Retrieving pluginfacts
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:24:52.893080215Z'
          file:
          line:
        - level: err
          message: 'Failed to generate additional resources using ''eval_generate'': execution
            expired'
          source: "/File[/opt/puppetlabs/puppet/cache/facts.d]"
          tags:
          - err
          - file
          - pluginfacts
          time: '2017-08-09T02:24:57.932640538Z'
          file:
          line:
        - level: err
          message: 'Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts:
            execution expired'
          source: "/File[/opt/puppetlabs/puppet/cache/facts.d]"
          tags:
          - err
          - file
          - pluginfacts
          time: '2017-08-09T02:25:02.938020623Z'
          file:
          line:
        - level: info
          message: Retrieving plugin
          source: Puppet
          tags:
          - info
          time: '2017-08-09T02:25:02.938324595Z'
          file:
          line:
        - level: err
          message: 'Failed to generate additional resources using ''eval_generate'': execution
            expired'
          source: "/File[/opt/puppetlabs/puppet/cache/lib]"
          tags:
          - err
          - file
          - plugin
          time: '2017-08-09T02:25:07.944977914Z'
          file:
          line:
        - level: err
          message: 'Could not evaluate: Could not retrieve file metadata for puppet:///plugins:
            execution expired'
          source: "/File[/opt/puppetlabs/puppet/cache/lib]"
          tags:
          - err
          - file
          - plugin
          time: '2017-08-09T02:25:12.950687959Z'
          file:
          line:
        - level: err
          message: 'Could not retrieve catalog from remote server: execution expired'
          source: Puppet
          tags:
          - err
          time: '2017-08-09T02:25:18.116096568Z'
          file:
          line:
        - level: warning
          message: Not using cache on failed catalog
          source: Puppet
          tags:
          - warning
          time: '2017-08-09T02:25:18.116323453Z'
          file:
          line:
        - level: err
          message: Could not retrieve catalog; skipping run
          source: Puppet
          tags:
          - err
          time: '2017-08-09T02:25:18.116528995Z'
          file:
          line:
        metrics: {}
        resource_statuses: {}
        corrective_change: false
        cached_catalog_status: not_used
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:55$ puppet agent --configprint node_name_value
        y9sqckmg348o6r5.delivery.puppetlabs.net
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.88 seconds
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:56$ rm -rf /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      
      y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  * master_used field should not appear in the report when not using the server_list setting
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:56$ puppet agent -t --server=y9sqckmg348o6r5.delivery.puppetlabs.net
      Info: Using configured environment 'production'
      Info: Retrieving pluginfacts
      Info: Retrieving plugin
      Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
      Info: Applying configuration version '1502245522'
      Notice: Applied catalog in 0.02 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.13 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:58$ puppet agent --configprint node_name_value
      y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.91 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:59$ cat /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
      --- !ruby/object:Puppet::Transaction::Report
      host: y9sqckmg348o6r5.delivery.puppetlabs.net
      time: '2017-08-09T02:25:21.547895333Z'
      configuration_version: 1502245522
      transaction_uuid: e6a2972d-1fb9-4a82-9f42-35d2220450cd
      report_format: 7
      puppet_version: 5.0.1
      status: unchanged
      noop: false
      noop_pending: false
      environment: production
      logs:
      - level: info
        message: Using configured environment 'production'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:25:21.699800470Z'
        file:
        line:
      - level: info
        message: Retrieving pluginfacts
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:25:21.700129551Z'
        file:
        line:
      - level: info
        message: Retrieving plugin
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:25:21.759099733Z'
        file:
        line:
      - level: info
        message: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:25:22.052739283Z'
        file:
        line:
      - level: info
        message: Applying configuration version '1502245522'
        source: Puppet
        tags:
        - info
        time: '2017-08-09T02:25:22.090283283Z'
        file:
        line:
      - level: notice
        message: Applied catalog in 0.02 seconds
        source: Puppet
        tags:
        - notice
        time: '2017-08-09T02:25:22.109906867Z'
        file:
        line:
      metrics:
        resources:
          name: resources
          label: Resources
          values:
          - - total
            - Total
            - 7
          - - skipped
            - Skipped
            - 0
          - - failed
            - Failed
            - 0
          - - failed_to_restart
            - Failed to restart
            - 0
          - - restarted
            - Restarted
            - 0
          - - changed
            - Changed
            - 0
          - - out_of_sync
            - Out of sync
            - 0
          - - scheduled
            - Scheduled
            - 0
          - - corrective_change
            - Corrective change
            - 0
        time:
          name: time
          label: Time
          values:
          - - schedule
            - Schedule
            - 0.001472774
          - - filebucket
            - Filebucket
            - 6.0401e-05
          - - config_retrieval
            - Config retrieval
            - 0.11026862700009588
          - - total
            - Total
            - 0.11180180200009587
        changes:
          name: changes
          label: Changes
          values:
          - - total
            - Total
            - 0
        events:
          name: events
          label: Events
          values:
          - - total
            - Total
            - 0
          - - failure
            - Failure
            - 0
          - - success
            - Success
            - 0
      resource_statuses:
        Schedule[puppet]:
          title: puppet
          file:
          line:
          resource: Schedule[puppet]
          resource_type: Schedule
          containment_path:
          - Schedule[puppet]
          evaluation_time: 6.4011e-05
          tags:
          - schedule
          - puppet
          time: '2017-08-09T02:25:22.096401413Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[hourly]:
          title: hourly
          file:
          line:
          resource: Schedule[hourly]
          resource_type: Schedule
          containment_path:
          - Schedule[hourly]
          evaluation_time: 6.0937e-05
          tags:
          - schedule
          - hourly
          time: '2017-08-09T02:25:22.096557287Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[daily]:
          title: daily
          file:
          line:
          resource: Schedule[daily]
          resource_type: Schedule
          containment_path:
          - Schedule[daily]
          evaluation_time: 0.000596512
          tags:
          - schedule
          - daily
          time: '2017-08-09T02:25:22.096708499Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[weekly]:
          title: weekly
          file:
          line:
          resource: Schedule[weekly]
          resource_type: Schedule
          containment_path:
          - Schedule[weekly]
          evaluation_time: 4.9973e-05
          tags:
          - schedule
          - weekly
          time: '2017-08-09T02:25:22.097396262Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[monthly]:
          title: monthly
          file:
          line:
          resource: Schedule[monthly]
          resource_type: Schedule
          containment_path:
          - Schedule[monthly]
          evaluation_time: 5.94e-05
          tags:
          - schedule
          - monthly
          time: '2017-08-09T02:25:22.097537172Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Schedule[never]:
          title: never
          file:
          line:
          resource: Schedule[never]
          resource_type: Schedule
          containment_path:
          - Schedule[never]
          evaluation_time: 0.000641941
          tags:
          - schedule
          - never
          time: '2017-08-09T02:25:22.097693332Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
        Filebucket[puppet]:
          title: puppet
          file:
          line:
          resource: Filebucket[puppet]
          resource_type: Filebucket
          containment_path:
          - Filebucket[puppet]
          evaluation_time: 6.0401e-05
          tags:
          - filebucket
          - puppet
          time: '2017-08-09T02:25:22.098437823Z'
          failed: false
          changed: false
          out_of_sync: false
          skipped: false
          change_count: 0
          out_of_sync_count: 0
          events: []
          corrective_change: false
      corrective_change: false
      catalog_uuid: 47de37fa-a7c7-4513-9472-bdfb75b8c970
      cached_catalog_status: not_used
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.05 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:29:59$ puppet agent --configprint node_name_value
      y9sqckmg348o6r5.delivery.puppetlabs.net
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.87 seconds
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:00$ rm -rf /tmp/report_dir.H3R3lK/y9sqckmg348o6r5.delivery.puppetlabs.net/*
    
    y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:00$ puppet master --configprint config
    /etc/puppetlabs/puppet/puppet.conf
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.89 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:01$ if [ -f '/tmp/failover_master.rb.PEzS5I/puppet.conf.bak' ]; then cat '/tmp/failover_master.rb.PEzS5I/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/failover_master.rb.PEzS5I/puppet.conf.bak'; fi
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:01$ service puppetserver reload
    Redirecting to /bin/systemctl reload  puppetserver.service
  
  y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.35 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:04$ rm -rf /tmp/report_dir.H3R3lK

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="finalized_on_cycle.rb" time="3.655156"><system-out><![CDATA[
Reports are finalized on resource cycles

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:04$ mktemp -dt report_finalized.XXXXXX
  /tmp/report_finalized.24lp9D

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:05$ puppet agent --configprint lastrunreport
  /opt/puppetlabs/puppet/cache/state/last_run_report.yaml

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds
localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-npk555 centos7-64-1:/tmp/report_finalized.24lp9D/check_report.rb {:ignore => }
localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-1g80a87 centos7-64-1:/tmp/report_finalized.24lp9D/manifest.pp {:ignore => }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:06$ puppet apply /tmp/report_finalized.24lp9D/manifest.pp
  Notice: Compiled catalog for y9sqckmg348o6r5.delivery.puppetlabs.net in environment production in 0.03 seconds
  Error: Found 1 dependency cycle:
  (Notify[bar] => Notify[foo] => Notify[bar])
  Try the '--graph' option and opening the resulting '.dot' file in OmniGraffle or GraphViz
  Error: Failed to apply catalog: One or more resource dependency cycles detected in graph

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.62 seconds
Exited: 1

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:07$ env PATH="/opt/puppetlabs/puppet/bin:${PATH}" ruby /tmp/report_finalized.24lp9D/check_report.rb /opt/puppetlabs/puppet/cache/state/last_run_report.yaml

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.91 seconds
Begin teardown
End teardown
]]></system-out></testcase><testcase classname="tests/reports" name="submission.rb" time="17.926689"><system-out><![CDATA[
Report submission

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:08$ puppet master --configprint user
  puppet

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:09$ getent passwd puppet
  puppet:x:996:994:puppetserver daemon:/opt/puppetlabs/server/data/puppetserver:/sbin/nologin

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:09$ mktemp -dt report_submission.XXXXXX
  /tmp/report_submission.ZchCt4

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:09$ chown puppet:puppet /tmp/report_submission.ZchCt4

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:09$ mktemp -dt submission.rb.XXXXXX
  /tmp/submission.rb.aWMJfE

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
Setting curl retries to 30

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:09$ puppet master --configprint confdir
  /etc/puppetlabs/puppet

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.09 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:10$ puppet master --configprint vardir
  /opt/puppetlabs/server/data/puppetserver

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:11$ test -e /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:11$ cat /etc/puppetlabs/puppetserver/conf.d/puppetserver.conf
  {
    "jruby-puppet": {
      "ruby-load-path": [
        "/opt/puppetlabs/puppet/lib/ruby/vendor_ruby"
      ],
      "gem-home": "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
      "gem-path": [
        "/opt/puppetlabs/server/data/puppetserver/jruby-gems",
        "/opt/puppetlabs/server/data/puppetserver/vendored-jruby-gems"
      ],
      "master-conf-dir": "/etc/puppetlabs/puppet",
      "master-code-dir": "/etc/puppetlabs/code",
      "master-var-dir": "/opt/puppetlabs/server/data/puppetserver",
      "master-run-dir": "/var/run/puppetlabs/puppetserver",
      "master-log-dir": "/var/log/puppetlabs/puppetserver"
    },
    "http-client": {
    },
    "profiler": {
    }
  }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-4oe0j0 centos7-64-1:/etc/puppetlabs/puppetserver/conf.d/puppetserver.conf {:ignore => }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:11$ puppet master --configprint confdir
  /etc/puppetlabs/puppet

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 1.05 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:12$ test -e /etc/puppetlabs/puppet/puppet.conf

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:12$ cp /etc/puppetlabs/puppet/puppet.conf /tmp/submission.rb.aWMJfE/puppet.conf.bak

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:12$ puppet master --configprint config
  /etc/puppetlabs/puppet/puppet.conf

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.86 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:13$ puppet master --configprint config
  /etc/puppetlabs/puppet/puppet.conf

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.92 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:14$ cat /etc/puppetlabs/puppet/puppet.conf
  # This file can be used to override the default puppet settings.
  # See the following links for more details on what settings are available:
  # - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html
  # - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html
  # - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html
  # - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html
  [master]
  vardir = /opt/puppetlabs/server/data/puppetserver
  logdir = /var/log/puppetlabs/puppetserver
  rundir = /var/run/puppetlabs/puppetserver
  pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
  codedir = /etc/puppetlabs/code

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
localhost $ scp /var/folders/8z/d3hkzy8j1wxfbmzwzmpf890w0000gq/T/beaker20170808-6664-zw8zdj centos7-64-1:/tmp/submission.rb.aWMJfE/puppet.conf {:ignore => }

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:14$ cat /etc/puppetlabs/puppet/puppet.conf
  [master]
  vardir = /opt/puppetlabs/server/data/puppetserver
  logdir = /var/log/puppetlabs/puppetserver
  rundir = /var/run/puppetlabs/puppetserver
  pidfile = /var/run/puppetlabs/puppetserver/puppetserver.pid
  codedir = /etc/puppetlabs/code
  
  [main]
  reportdir = /tmp/report_submission.ZchCt4
  reports = store

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:15$ service puppetserver reload
  Redirecting to /bin/systemctl reload  puppetserver.service

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 4.38 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:19$ puppet agent -t --server y9sqckmg348o6r5.delivery.puppetlabs.net
  Info: Using configured environment 'production'
  Info: Retrieving pluginfacts
  Info: Retrieving plugin
  Info: Caching catalog for y9sqckmg348o6r5.delivery.puppetlabs.net
  Info: Applying configuration version '1502245545'
  Notice: Applied catalog in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 2.30 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:21$ puppet agent --configprint node_name_value
  y9sqckmg348o6r5.delivery.puppetlabs.net

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.80 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:22$ grep -q y9sqckmg348o6r5.delivery.puppetlabs.net /tmp/report_submission.ZchCt4/*/*

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:22$ puppet master --configprint config
  /etc/puppetlabs/puppet/puppet.conf

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.79 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:23$ if [ -f '/tmp/submission.rb.aWMJfE/puppet.conf.bak' ]; then cat '/tmp/submission.rb.aWMJfE/puppet.conf.bak' > '/etc/puppetlabs/puppet/puppet.conf'; rm -f '/tmp/submission.rb.aWMJfE/puppet.conf.bak'; fi

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.04 seconds

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:23$ service puppetserver reload
  Redirecting to /bin/systemctl reload  puppetserver.service

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 3.20 seconds
Begin teardown

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) 19:30:26$ rm -rf /tmp/report_submission.ZchCt4

y9sqckmg348o6r5.delivery.puppetlabs.net (centos7-64-1) executed in 0.03 seconds
End teardown
]]></system-out></testcase></testsuite></testsuites>
